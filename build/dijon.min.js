var dijon;!function(t){var e;!function(t){var e=function(){function t(){}return t.ASSET_MANAGER_DATA_SET="dijonAssetManagerDataSet",t.ASSET_MANAGER_ASSETS_CLEARED="dijonAssetManagerAssetsCleared",t}();t.Notifications=e}(e=t.utils||(t.utils={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this._data={},this._baseURL="",this._pathObj={},this._assetPath=null,this._dataPath=null,this._spriteSheetPath=null,this._imgPath=null,this._fontPath=null,this._audioSpritePath=null,this._soundPath=null,this._soundDecodingModifier=2,this._resolution=null,this._loadData={},this._autoLoadData={},this._completedLoads={},this._requiredData={},this._currentAssetList=null,this._hasFiles=!1,this._soundsToDecode=[],this._isLoadingQueue=!1,this._maxPercent=100,this._numSounds=0,this._soundsDecoded=0,this.onLoadStart=new Phaser.Signal,this.onFileStart=new Phaser.Signal,this.onFileComplete=new Phaser.Signal,this.onLoadComplete=new Phaser.Signal,this.onLoadCompleteAndAudioDecoded=new Phaser.Signal,this.onBackgroundLoadStart=new Phaser.Signal,this.onBackgroundFileStart=new Phaser.Signal,this.onBackgroundFileComplete=new Phaser.Signal,this.onBackgroundLoadComplete=new Phaser.Signal,this.onBackgroundLoadCompleteAndAudioDecoded=new Phaser.Signal,this._init()}return e.prototype._init=function(){this.app=t.mvc.Application.getInstance(),this.game=this.app.game,this.setBaseURL(),this.setPaths(),this.setResolution()},e.prototype._parseAssetList=function(t,e){var o=this;this._autoLoadData[t]=e.autoload,this._requiredData[t]=e.required,this._loadData[t]=[],e.assets.forEach(function(e){o._loadData[t].push(e)})},e.prototype._loadAssets=function(t){var e,o=this._loadData[t];for(e=0;e<o.length;e++)this._loadAsset(o[e])},e.prototype._backgroundLoadStart=function(){this.onBackgroundLoadStart.dispatch()},e.prototype._backgroundFileComplete=function(t,e,o,i){this.onBackgroundFileComplete.dispatch(t,e,o,i)},e.prototype._backgroundLoadComplete=function(){this.game.load.onFileComplete.remove(this._backgroundFileComplete,this),this.onBackgroundLoadComplete.dispatch(),this._checkSoundDecoding(this.onBackgroundLoadCompleteAndAudioDecoded)},e.prototype._gameLoadStart=function(){this.onLoadStart.dispatch()},e.prototype._gameFileStart=function(){this.onFileStart.dispatch()},e.prototype._gameFileComplete=function(t,e,o,i){this.onFileComplete.dispatch(this.getLoadProgress(t),e,o,i)},e.prototype._gameLoadComplete=function(){this._completedLoads[this._currentAssetList]=!0,this.onLoadComplete.dispatch(),this.game.load.onFileStart.remove(this._gameFileStart,this),this.game.load.onFileComplete.remove(this._gameFileComplete,this),this._checkSoundDecoding(this.onLoadCompleteAndAudioDecoded)},e.prototype._checkSoundDecoding=function(t){var e,o,i;if(this._soundsToDecode&&this._soundsToDecode.length>0)for(o=0;o<this._soundsToDecode.length;o++)i=this._soundsToDecode[o].isAudioSprite,e=this.game.add.sound(this._soundsToDecode[o].url),e.__isAudioSprite=i,e.eventToDispatch=t,e.onDecoded.addOnce(this._onSoundDecoded,this);else t.dispatch()},e.prototype._onSoundDecoded=function(t){var e=this._soundsToDecode.indexOf(t.key);this._soundsToDecode.splice(e,1),"undefined"!=typeof this.game.audio&&"undefined"!=typeof this.game.audio.addAudio&&(t.__isAudioSprite&&this.game.add.audioSprite(t.key),this.game.audio.addAudio(t.key,t.__isAudioSprite)),this._soundsDecoded++,this._maxPercent=100-this._numSounds*this.getSoundDecodingModifier()+this._soundsDecoded*this.getSoundDecodingModifier(),this._gameFileComplete(100),0===this._soundsToDecode.length&&t.eventToDispatch.dispatch()},e.prototype._getAssetKey=function(t){var e=t.split(".");return e.pop(),e.join("")},e.prototype._getExtension=function(t){return t.split(".").pop()},e.prototype._loadAsset=function(t){var o=t.type,i=t.url||t.key;switch(o){case e.ASSET_LIST:return this._loadAssets(t.id);case e.SOUND:this.loadSound(i,t.extensions);break;case e.AUDIO_SPRITE:this.loadAudioSprite(i,t.extensions);break;case e.IMAGE:this.loadImage(i);break;case e.ATLAS:this.loadAtlas(i);break;case e.TEXT:this.loadText(i)}},e.prototype._parseData=function(){var t;for(t in this._data)this._parseAssetList(t,this._data[t])},e.prototype.setBaseURL=function(t){void 0===t&&(t=""),t&&""!==t&&"/"!==t.charAt(t.length-1)&&(t+="/"),this._baseURL=t,this.setPaths()},e.prototype.setPaths=function(t){void 0===t&&(t=null),this._pathObj=t||{},this._assetPath=this._baseURL+(this._pathObj.assetPath||"assets"),this._dataPath=this._baseURL+(this._pathObj.dataPath||"assets/data"),this._spriteSheetPath=this._baseURL+(this._pathObj.spritesheetPath||"assets/img/spritesheets"),this._imgPath=this._baseURL+(this._pathObj.imgPath||"assets/img"),this._fontPath=this._baseURL+(this._pathObj.fontPath||"assets/fonts"),this._audioSpritePath=this._baseURL+(this._pathObj.audioSpritePath||"assets/audio/sprite"),this._soundPath=this._baseURL+(this._pathObj.soundPath||"assets/audio/sound")},e.prototype.setResolution=function(t){"undefined"==typeof t&&(t=this.game.resolution),this._resolution=""},e.prototype.setSoundDecodingModifier=function(t){void 0===t&&(t=2),this._soundDecodingModifier=t},e.prototype.getSoundDecodingModifier=function(){return this._soundDecodingModifier},e.prototype.loadText=function(t){var e=this._getAssetKey(t);return this.game.load.text(e,this._dataPath+"/"+t)},e.prototype.loadAtlas=function(t){return this.game.cache.checkImageKey(t)?t:this.game.load.atlasJSONHash(t,this._spriteSheetPath+"/"+t+this._resolution+".png",this._spriteSheetPath+"/"+t+this._resolution+".json")},e.prototype.loadImage=function(t){var e=this._getAssetKey(t);return this.game.cache.checkImageKey(e)?e:(t=e+this._resolution+"."+this._getExtension(t),this.game.load.image(e,this._imgPath+"/"+t))},e.prototype.loadBitmapFont=function(t){this.game.load.bitmapFont(t,this._fontPath+"/"+t+".png",this._fontPath+"/"+t+".fnt")},e.prototype.loadAudio=function(t,e,o){var i,n;if(!this.game.cache.checkSoundKey(t)||!this.game.cache.getSound(t).isDecoded){if("undefined"==typeof i&&(i="sound"),e.indexOf(",")>=0&&(e=e.split(",")),this.game.device.iOS&&-1===e.indexOf("m4a")&&e.unshift("m4a"),"object"==typeof e){n=[];for(var s=0;s<e.length;s++)n.push((o?this._audioSpritePath:this._soundPath)+"/"+t+"."+e[s])}else n=(o?this._audioSpritePath:this._soundPath)+"/"+i+"/"+t+"."+e;o?this.game.load.audiosprite(t,n,this._audioSpritePath+"/"+t+".json"):this.game.load.audio(t,n),this._soundsToDecode.push({url:t,isAudioSprite:o})}},e.prototype.loadSound=function(t,e){return this.loadAudio(t,e,!1)},e.prototype.loadAudioSprite=function(t,e){return this.loadAudio(t,e,!0)},e.prototype.loadAssets=function(t,e){return void 0===e&&(e=!1),this._currentAssetList=t,this.game.load.onFileComplete.remove(this._backgroundFileComplete,this),this.game.load.onFileComplete.remove(this._gameFileComplete,this),this.game.load.reset(),this._hasFiles=!1,this._soundsToDecode=[],"undefined"!=typeof this._data?"undefined"==typeof this._data[t]||this._data[t].length<1?console.log("no preload data registered for ",t):(this._loadAssets(t),this._hasFiles=this.game.load.totalQueuedFiles()>0,e?(this.game.load.onLoadStart.addOnce(this._backgroundLoadStart,this),this.game.load.onFileComplete.add(this._backgroundFileComplete,this),this.game.load.onLoadComplete.addOnce(this._backgroundLoadComplete,this)):(this.game.load.onLoadStart.addOnce(this._gameLoadStart,this),this.game.load.onFileStart.add(this._gameFileStart,this),this.game.load.onFileComplete.add(this._gameFileComplete,this),this.game.load.onLoadComplete.addOnce(this._gameLoadComplete,this)),this._hasFiles?(this._numSounds=this._soundsToDecode.length,this._soundsDecoded=0,this._maxPercent=100-this._numSounds*this.getSoundDecodingModifier(),this.game.load.start()):(this._gameLoadStart(),this._gameFileComplete(100),void this._gameLoadComplete())):void 0},e.prototype.loadQueue=function(){if(!this._isLoadingQueue){if("undefined"==typeof this._data)return console.log("no preload queue to load");var t;for(var e in this._data)if(this._autoLoadData[e]){t=this._data[e];for(var o=0;o<t.length;o++)this._loadAsset(t[o])}this.game.load.start(),this._isLoadingQueue=!0,this.game.load.onLoadStart.addOnce(this._backgroundLoadStart,this),this.game.load.onFileComplete.add(this._backgroundFileComplete,this),this.game.load.onLoadComplete.addOnce(this._backgroundLoadComplete,this)}},e.prototype.getLoadProgress=function(t){var e=t*this._maxPercent/100;return e},e.prototype.allSoundsDecoded=function(){return 0===this._soundsToDecode.length},e.prototype.setData=function(e){this._data=JSON.parse(e),this._loadData={},this._parseData(),this.sendNotification(t.utils.Notifications.ASSET_MANAGER_DATA_SET,this._data)},e.prototype.clearAssets=function(e,o,i,n,s){void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!0);var a=this._data[e];if(console.log("clearing: ",e),!a||"undefined"==typeof a||a.length<1)return console.log("no assets",a);o=o!==!1,i=i!==!1,n=n!==!1,s=s!==!1;for(var r=0;r<a.length;r++)this.clearAsset(a[r],o,i,n,s);this._completedLoads[e]=!1,this.sendNotification(t.utils.Notifications.ASSET_MANAGER_ASSETS_CLEARED,e)},e.prototype.clearAsset=function(t,o,i,n,s){void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!0);var a=t.type,r=t.url,d=t.required;if(d)return void console.log("the "+a+" asset: "+r+" is required and will not be cleared");switch(a){case e.AUDIO:o&&(this.game.sound.removeByKey(r),this.game.cache.removeSound(r));break;case e.IMAGE:n&&(this.game.cache.removeImage(r),PIXI.BaseTextureCache[r].destroy());break;case e.ATLAS:i&&(this.game.cache.removeImage(r),PIXI.BaseTextureCache[r].destroy(),this.game.cache.removeXML(r));break;case e.TEXT:s&&this.game.cache.removeText(r)}},e.prototype.hasLoadedAssets=function(t){return this._completedLoads[t]===!0},e.prototype.sendNotification=function(t,e){return this.app.sendNotification(t,e)},e.AUDIO="audio",e.SOUND="sound",e.AUDIO_SPRITE="audioSprite",e.IMAGE="image",e.ATLAS="atlas",e.TEXT="text",e.ASSET_LIST="assetList",e.RESOLUTION_2X="@2x",e.RESOLUTION_3X="@3x",e}();e.AssetManager=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this._defaultInterval=20,this.game=t.mvc.Application.getInstance().game}return e.prototype._executeMethod=function(t,e,o,i){var n=t.shift();"undefined"!=typeof n&&"undefined"!=typeof e&&e&&n.call(e),0===t.length&&o&&i&&o.call(i)},e.prototype.run=function(t,e,o,i,n){if("undefined"==typeof e)throw new Error("context must be provided for the sequence methods");if("undefined"==typeof o&&(o=this._defaultInterval),0===t.length&&"undefined"!=typeof i&&"undefined"!=typeof n)return void i.call(n);if(0!==o)this.game.time.events.repeat(o,t.length,this._executeMethod,this,t,e,"undefined"==typeof i?null:i,"undefined"==typeof n?null:n);else for(;t.length>0;)this._executeMethod(t,e,"undefined"==typeof i?null:i,"undefined"==typeof n?null:n)},e}();e.SequenceManager=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this.onTransitionOutComplete=new Phaser.Signal,this.onTransitionInComplete=new Phaser.Signal,this._transition=null,this._transitions={},this._exceptions={},this._fromState=null,this._toState=null,this.game=t.mvc.Application.getInstance().game}return e.prototype._add=function(t,e,o,i){this._transitions[t]={outHandler:e,preloadHandler:o,inHandler:i}},e.prototype._getTransition=function(t,e){var o=this._transitions[t+"/"+e];return"undefined"==typeof o&&(o=this._transitions.all),"undefined"==typeof o?null:o},e.prototype._transitionInComplete=function(){return this._transition=this._getTransition(this._fromState,this._toState),this._transition?("function"==typeof this._transition.preloadHandler.loadStart&&this.game.asset.onLoadStart.addOnce(this._transition.preloadHandler.loadStart,this._transition.preloadHandler),"function"==typeof this._transition.preloadHandler.loadProgress&&this.game.asset.onFileComplete.add(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),this.game.asset.onLoadCompleteAndAudioDecoded.addOnce(this._preloadComplete,this),this.onTransitionInComplete.dispatch(),void this.game.changeState(this._toState)):!1},e.prototype._transitionOutComplete=function(){this._transition=null,this.onTransitionOutComplete.dispatch()},e.prototype._preloadComplete=function(){return this._transition=this._getTransition(this._fromState,this._toState),this._transition?(this.game.asset.onFileComplete.remove(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),void("function"==typeof this._transition.preloadHandler.loadComplete&&this._transition.preloadHandler.loadComplete())):!1},e.prototype._clearTransition=function(){this._transition.outHandler.transitionInComplete.remove(this._transitionOutComplete,this),this._transition.inHandler.transitionOutComplete.remove(this._transitionInComplete,this),this.game.asset.onLoadCompleteAndAudioDecoded.remove(this._preloadComplete,this),this.game.asset.onLoadStart.remove(this._transition.preloadHandler.loadStart,this._transition.preloadHandler),this.game.asset.onFileComplete.remove(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),this._transition=null},e.prototype.add=function(t,e,o,i,n){var s;return arguments.length<5?"all"===t?(s=[].slice.call(arguments,1),2===arguments.length?this._add("all",s[0],s[0],s[0]):this._add("all",s[0],s[1],s[2])):(s=[].slice.call(arguments,2),this._add(t+"/"+e,s[0],s[0],s[0])):this._add(t+"/"+e,o,i,n)},e.prototype.addException=function(t){this._exceptions[t]=!0},e.prototype.remove=function(t,e){1===arguments.length?(this._transitions[t]=null,delete this._transitions[t]):(this._transitions[t+"/"+e]=null,delete this._transitions[t+"/"+e])},e.prototype.to=function(t){this._transition&&this._clearTransition(),this._exceptions[t]||(this._fromState=this.game.state.current,this._toState=t,this._transition=this._getTransition(this._fromState,this._toState),this._transition||(console.log("no transition found for:",this.game.state.current+" to "+t),this.game.changeState(this._toState)),this.transitionIn())},e.prototype.transitionIn=function(){this._transition&&"function"==typeof this._transition.outHandler.transitionIn&&(this._transition.outHandler.transitionInComplete.addOnce(this._transitionInComplete,this),this._transition.outHandler.transitionIn())},e.prototype.transitionOut=function(){return this._transition?this._exceptions[this.game.state.current]?!1:("function"==typeof this._transition.inHandler.transitionOut&&(this._transition.inHandler.transitionOutComplete.addOnce(this._transitionOutComplete,this),this._transition.inHandler.transitionOut()),!0):!1},e}();e.TransitionManager=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this.game=t.mvc.Application.getInstance().game,this._init()}return e.prototype._init=function(){this._localStorageAvailable=this._getIsLocalStorageAvailable(),console.log("local storage available",this._localStorageAvailable)},e.prototype._getIsLocalStorageAvailable=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},e.prototype._getString=function(t){if("string"==typeof t)return t;var e;try{e=JSON.stringify(t)}catch(o){return console.log("Could not convert"+t+" to json"),null}return e},e.prototype.getFromLocalStorage=function(t,e){void 0===e&&(e=!0);var o=localStorage.getItem(t);return"undefined"==typeof o?(console.log("no data saved with the key",t),null):(e!==!1&&(o=JSON.parse(o)),o)},e.prototype.saveToLocalStorage=function(t,e){if(!this._localStorageAvailable)return console.log("no local storage"),!1;try{localStorage.setItem(t,this._getString(e))}catch(o){console.log("your data could not be saved")}},e.prototype.clearFromLocalStorage=function(t){if(!this._localStorageAvailable)return console.log("no local storage"),!1;try{localStorage.removeItem(t)}catch(e){}},e}();e.StorageManager=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this._defaultVolume=1,this._sprites={},this._sounds={},this._markerLookup={},this.game=t.mvc.Application.getInstance().game}return e.prototype._addAudio=function(t,e){return void 0===e&&(e=!1),e===!0?this._parseAudioSprite(t,this.game.add.audioSprite(t)):this._allowMultiple(this.game.add.sound(t))},e.prototype._parseAudioSprite=function(t,e){for(var o in e.sounds)this._allowMultiple(e.sounds[o]),this._markerLookup[o]=t;return e},e.prototype._allowMultiple=function(t){return t.allowMultiple=!0,t},e.prototype._getKeyFromMarkerName=function(t){if("undefined"!=typeof this._markerLookup[t])return this._markerLookup[t];for(var e in this._sprites)if("undefined"!=typeof this._sprites[e].sounds[t])return this._markerLookup[t]=e,e;return!1},e.prototype._playSpriteMarker=function(t,e,o,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!0),"undefined"!=typeof o?"string"==typeof o&&(o=o.indexOf("+")>=0||o.indexOf("-")>=0?this._defaultVolume+parseFloat(o):parseFloat(o)):o=this._defaultVolume,i=i||!1,n=n===!1?!1:!0,this._sprites[t].play(e,o)},e.prototype._stopSpriteMarker=function(t,e){return"undefined"==typeof this._sprites||"undefined"==typeof this._sprites[t]?!1:this._sprites[t].stop(e)},e.prototype._stopSound=function(t){return t.stop()},e.prototype.addAudio=function(t,e){return void 0===e&&(e=!1),e===!0?this.addAudioSprite(t):this.addSound(t)},e.prototype.addSound=function(t){return"undefined"!=typeof this._sounds[t]?this._sounds[t]:(this._sounds[t]=this.game.add.audio(t),this._sounds[t].allowMultiple=!0,this._sounds[t])},e.prototype.addAudioSprite=function(t){return"undefined"!=typeof this._sprites[t]?this._sprites[t]:(this._sprites[t]=this._addAudio(t,!0),this._sprites[t])},e.prototype.playAudio=function(t,e,o,i){return void 0===o&&(o=!1),void 0===i&&(i=!0),this._getKeyFromMarkerName(t)?this.playSpriteMarker(t,e,o,i):this.playSound(t,e,o,i)},e.prototype.playDelayedAudio=function(t,e,o,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!0),this._getKeyFromMarkerName(e)?this.playDelayedSpriteMarker(t,e,o,i,n):this.playDelayedSound(t,e,o,i,n)},e.prototype.playSound=function(t,e,o,i){return void 0===o&&(o=!1),void 0===i&&(i=!0),"undefined"==typeof this._sounds[t]?!1:(e="undefined"==typeof e?this._defaultVolume:e,this._sounds[t].play("",0,e,o,i))},e.prototype.playSpriteMarker=function(t,e,o,i){void 0===o&&(o=!1),void 0===i&&(i=!0);var n=this._getKeyFromMarkerName(t);return n?this._playSpriteMarker(n,t,e,o,i):(console.log("marker not found",t),!1)},e.prototype.playDelayedSound=function(t,e,o,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0),this.game.time.events.add(t,this.playSound,this,e,o,i,n)},e.prototype.playDelayedSpriteMarker=function(t,e,o,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0),this.game.time.events.add(t,this.playSpriteMarker,this,e,o,i,n)},e.prototype.stopAudio=function(t){return this._getKeyFromMarkerName(t)?this.stopSpriteMarker(t):this.stopSound(t)},e.prototype.stopSound=function(t){return"undefined"!=typeof this._sounds&&"undefined"!=typeof this._sounds[t]?this._sounds[t].stop():void 0},e.prototype.stopSpriteMarker=function(t){var e=this._getKeyFromMarkerName(t);return e?void this._stopSpriteMarker(e,t):void console.log("marker not found",t)},e.prototype.removeSound=function(t){return"undefined"==typeof this._sounds||"undefined"==typeof this._sounds[t]?!1:void(this._sounds[t]&&(this.stopSound(t),this._sounds[t].destroy(),delete this._sounds[t]))},e.prototype.removeSprite=function(t){"undefined"!=typeof this._sprites&&"undefined"!=typeof this._sprites[t]&&(this.stopSpriteMarker(t),this._sprites[t]=null,delete this._sprites[t])},e.prototype.fade=function(t,e,o,i){return void 0===i&&(i=!1),t?(t.fadeTween&&t.fadeTween&&this.game.tweens.remove(t.fadeTween),t.fadeTween=this.game.add.tween(t).to({volume:e},o||300,Phaser.Easing.Linear.None),i===!0&&t.fadeTween.onComplete.addOnce(function(){this._stopSound(t)},this),t.fadeTween.start()):void 0},Object.defineProperty(e.prototype,"defaultVolume",{get:function(){return this._defaultVolume},set:function(t){this._defaultVolume=t},enumerable:!0,configurable:!0}),e}();e.AudioManager=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function e(){this.game=t.mvc.Application.getInstance().game,this.name="Component"}return e.prototype.setOwner=function(t){this.owner=t},e.prototype.init=function(){},e.prototype.buildInterface=function(){},e.prototype.update=function(){},e.prototype.destroy=function(){},e}();e.Component=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);o.prototype=e.prototype,t.prototype=new o},dijon;!function(t){var e;!function(e){var o=function(e){function o(o,i,n,s,a,r){void 0===a&&(a="dSprite"),void 0===r&&(r=null),e.call(this,t.mvc.Application.getInstance().game,o,i,n,s),this.name=a,this._hasComponents=!1,this._componentKeys=[],this._components={},this.addComponents=function(t){if("undefined"==typeof t.length)throw new Error("Dijon.UIGroup components must be an array");for(;t.length>0;)this.addComponent(t.shift())},this.init(),this.buildInterface(),r&&this.addComponents(r)}return __extends(o,e),o.prototype.update=function(){this._hasComponents&&this.updateComponents()},o.prototype.destroy=function(){this.removeAllComponents(),e.prototype.destroy.call(this)},o.prototype.init=function(){},o.prototype.buildInterface=function(){},o.prototype._updateComponentKeys=function(){this._componentKeys=Object.keys(this._components),this._hasComponents=this._componentKeys.length>0},o.prototype.addComponent=function(t){return t.setOwner(this),t.init(),t.buildInterface(),this._components[t.name]=t,this._updateComponentKeys(),t},o.prototype.updateComponents=function(){var t=this;this._componentKeys.forEach(function(e){t.updateComponent(e)})},o.prototype.updateComponent=function(t){this._components[t].update()},o.prototype.removeAllComponents=function(){for(;this._componentKeys.length>0;)this.removeComponent(this._componentKeys.pop())},o.prototype.removeComponent=function(t){"undefined"!=typeof this._components[t]&&(this._components[t].destroy(),this._components[t]=null,delete this._components[t],this._updateComponentKeys())},o}(Phaser.Sprite);e.Sprite=o}(e=t.display||(t.display={}))}(dijon||(dijon={})),Phaser.GameObjectCreator.prototype.dSprite=function(t,e,o,i,n,s){return void 0===n&&(n="dSprite"),void 0===s&&(s=null),new dijon.display.Sprite(t,e,o,i,n,s)};var dijon;!function(t){var e;!function(e){var o=function(e){function o(i,n,s,a,r,d,u,h,p,l,c){void 0===s&&(s=""),void 0===r&&(r=o.DEFAULT_FONT_SIZE),void 0===d&&(d=o.DEFAULT_FONT_COLOR),void 0===u&&(u="left"),void 0===h&&(h=!1),void 0===p&&(p=0),void 0===l&&(l=0),void 0===c&&(c=null),e.call(this,t.mvc.Application.getInstance().game,i,n,s,o._addSettings({font:r+"px "+a,fill:d,align:u,wordWrap:h,wordWrapWidth:p},c)),this.lineSpacing=l,this.onAnimationComplete=new Phaser.Signal,this._canUpdate=!1,this._textToAnimate=[],this.stopAnimating=function(){this._canUpdate=!1,this._textToAnimate=null,this.game.time.events.remove(this._delayTimer),this.game.time.events.remove(this._repeatTimer)},this.roundPixel=function(){this.position.set(Math.round(this.x),Math.round(this.y))},this.text=s.replace(/'/g,"'"),this.resolution=this.game.resolution}return __extends(o,e),o.prototype.setText=function(t){return e.prototype.setText.call(this,t),this._lowercaseText=this.text.toLowerCase(),this.game&&(this.resolution=this.game.resolution),this},o.prototype._startTextAnimation=function(){this._canUpdate=!0,this._repeatTimer=this.game.time.events.repeat(100*this._letterTime,this._textLength,this._updateTextAnimation,this)},o.prototype._updateTextAnimation=function(){if(!this._canUpdate||!this._textToAnimate)return!1;var t=this._textLength-this._textToAnimate.length;this.addColor(this.style.fill,t),this.addColor("rgba(0,0,0,0)",t+1),this._textToAnimate.shift(),0===this._textToAnimate.length&&this.onAnimationComplete.dispatch()},o.prototype.setColor=function(t){return this.highlightPhrase(this.text,t,!1)},o.prototype.resetColor=function(){return this.highlightPhrase(this.text,this.style.fill,!1)},o.prototype.highlightPhrase=function(t,e,o){void 0===o&&(o=!1);var i=o?this.text:this._lowercaseText;t=o?t:t.toLowerCase();for(var n=t.length,s=i.indexOf(t),a=s+n;a>=s;)this.addColor(e,s),s++;this.addColor(this.style.fill,a)},o.prototype.animate=function(t,e){void 0===t&&(t=.1),void 0===e&&(e=0),this.game.time.events.remove(this._delayTimer),this.game.time.events.remove(this._repeatTimer),this._letterTime=t,this._textLength=this.text.length,this._textToAnimate=this.text.split("");for(var o=0,i=this._textLength;i>=o;)this.addColor("rgba(0,0,0,0)",o),o++;this._delayTimer=this.game.time.events.add(e*Phaser.Timer.SECOND,this._startTextAnimation,this)},o._addSettings=function(t,e){if(!e)return t;for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t},o.DEFAULT_FONT_SIZE=12,o.DEFAULT_FONT_COLOR="#000000",o.DEFAULT_FONT="Helvetica Neue, Arial",o.GLOBAL_PADDING_X=0,o.GLOBAL_PADDING_Y=0,o}(Phaser.Text);e.Text=o}(e=t.display||(t.display={}))}(dijon||(dijon={})),Phaser.GameObjectCreator.prototype.dText=function(t,e,o,i,n,s,a,r,d,u,h){return void 0===o&&(o=""),void 0===n&&(n=dijon.display.Text.DEFAULT_FONT_SIZE),void 0===s&&(s=dijon.display.Text.DEFAULT_FONT_COLOR),void 0===a&&(a="left"),void 0===r&&(r=!1),void 0===d&&(d=0),void 0===u&&(u=0),void 0===h&&(h=null),new dijon.display.Text(t,e,o,i,n,s,a,r,d,u,h)};var dijon;!function(t){var e;!function(e){var o=function(e){function o(o,i,n,s,a,r,d){void 0===o&&(o=0),void 0===i&&(i=0),void 0===n&&(n="dGroup"),void 0===s&&(s=!1),void 0===a&&(a=null),e.call(this,t.mvc.Application.getInstance().game,null,n,s,r,d),this.name=n,this._hasComponents=!1,this._componentKeys=[],this._components={},this.addComponents=function(t){if("undefined"==typeof t.length)throw new Error("Dijon.UIGroup components must be an array");for(;t.length>0;)this.addComponent(t.shift())},this.position.set(o,i),this.init(),s||this.game.add.existing(this),this.buildInterface(),a&&this.addComponents(a)}return __extends(o,e),o.prototype.update=function(){this._hasComponents&&this.updateComponents()},o.prototype.destroy=function(){this.removeAllComponents(),e.prototype.destroy.call(this)},o.prototype.init=function(){},o.prototype.buildInterface=function(){},o.prototype._updateComponentKeys=function(){this._componentKeys=Object.keys(this._components),this._hasComponents=this._componentKeys.length>0},o.prototype.addComponent=function(t){return t.setOwner(this),t.init(),t.buildInterface(),this._components[t.name]=t,this._updateComponentKeys(),t},o.prototype.updateComponents=function(){var t=this;this._componentKeys.forEach(function(e){t.updateComponent(e)})},o.prototype.updateComponent=function(t){this._components[t].update()},o.prototype.removeAllComponents=function(){for(;this._componentKeys.length>0;)this.removeComponent(this._componentKeys.pop())},o.prototype.removeComponent=function(t){"undefined"!=typeof this._components[t]&&(this._components[t].destroy(),this._components[t]=null,delete this._components[t],this._updateComponentKeys())},Object.defineProperty(o.prototype,"addInternal",{get:function(){return this.game.add.defaultGroup=this,this.game.add},enumerable:!0,configurable:!0}),o}(Phaser.Group);e.Group=o}(e=t.display||(t.display={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(e){function o(){e.apply(this,arguments),this._defaultGroup=null}return __extends(o,e),o.prototype.existing=function(t){var e=this.defaultGroup;return this.defaultGroup=null,e.add(t)},o.prototype.image=function(t,e,o,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultGroup),this.defaultGroup=null,n.add(new Phaser.Image(this.game,t,e,o,i))},o.prototype.sprite=function(t,e,o,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultGroup),this.defaultGroup=null,n.create(t,e,o,i)},o.prototype.creature=function(t,e,o,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultGroup),this.defaultGroup=null;var s=new Phaser.Creature(this.game,t,e,o,i);return n.add(s),s},o.prototype.group=function(t,e,o,i,n){return void 0===e&&(e="group"),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===t&&(t=this.defaultGroup),this.defaultGroup=null,new Phaser.Group(this.game,t,e,o,i,n)},o.prototype.physicsGroup=function(t,e,o,i){return void 0===t&&(t=0),void 0===o&&(o="group"),void 0===i&&(i=!1),void 0===e&&(e=this.defaultGroup),this.defaultGroup=null,new Phaser.Group(this.game,e,o,i,!0,t)},o.prototype.spriteBatch=function(t,e,o){return void 0===e&&(e="spriteBatch"),void 0===o&&(o=!1),void 0===t&&(t=this.defaultGroup),this.defaultGroup=null,new Phaser.SpriteBatch(this.game,t,e,o)},o.prototype.tileSprite=function(t,e,o,i,n,s,a){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=this.defaultGroup),this.defaultGroup=null,a.add(new Phaser.TileSprite(this.game,t,e,o,i,n,s))},o.prototype.rope=function(t,e,o,i,n,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===s&&(s=this.defaultGroup),this.defaultGroup=null,s.add(new Phaser.Rope(this.game,t,e,o,i,n))},o.prototype.text=function(t,e,o,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=""),void 0===n&&(n=this.defaultGroup),this.defaultGroup=null,n.add(new Phaser.Text(this.game,t,e,o,i))},o.prototype.button=function(t,e,o,i,n,s,a,r,d,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===u&&(u=this.defaultGroup),this.defaultGroup=null,u.add(new Phaser.Button(this.game,t,e,o,i,n,s,a,r,d))},o.prototype.graphics=function(t,e,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=this.defaultGroup),this.defaultGroup=null,o.add(new Phaser.Graphics(this.game,t,e))},o.prototype.bitmapText=function(t,e,o,i,n,s,a){return void 0===i&&(i=""),void 0===n&&(n=32),void 0===a&&(a=this.defaultGroup),this.defaultGroup=null,a.add(new Phaser.BitmapText(this.game,t,e,o,i,n,s))},o.prototype.dSprite=function(e,o,i,n,s,a,r){return void 0===r&&(r=this.defaultGroup),this.defaultGroup=null,r.add(new t.display.Sprite(e,o,i,n,s,a))},o.prototype.dGroup=function(e,o,i,n,s,a,r,d){return void 0===d&&(d=this.defaultGroup),this.defaultGroup=null,d.add(new t.display.Group(e,o,i,n,s,a,r))},o.prototype.dText=function(e,o,i,n,s,a,r,d,u,h,p,l){return void 0===l&&(l=this.defaultGroup),this.defaultGroup=null,l.add(new t.display.Text(e,o,i,n,s,a,r,d,u,h,p))},Object.defineProperty(o.prototype,"defaultGroup",{get:function(){return this._defaultGroup||this.world},set:function(t){this._defaultGroup=t},enumerable:!0,configurable:!0}),o}(Phaser.GameObjectFactory);e.GameObjectFactory=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(o){function i(t){o.call(this,t),this["debugger"]=null}return __extends(i,o),i.prototype.boot=function(){o.prototype.boot.call(this),this.app=t.mvc.Application.getInstance(),this.asset=new e.AssetManager,this.sequence=new e.SequenceManager,this.transition=new e.TransitionManager,this.storage=new e.StorageManager,this.audio=new e.AudioManager,this.analytics=new e.AnalyticsManager,this.add=null,this.add=new e.GameObjectFactory(this),this.gameLayer=this.add.group(this.world,"_game_layer"),this.uiLayer=this.add.group(this.world,"_ui_layer")},i.prototype.changeState=function(t){return this.gameLayer.removeAll(!0,!0),this.state.start(t,!1,!1)},Object.defineProperty(i.prototype,"addToGame",{get:function(){return this.add.defaultGroup=this.gameLayer,this.add},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"addToUI",{get:function(){return this.add.defaultGroup=this.uiLayer,this.add},enumerable:!0,configurable:!0}),i}(Phaser.Game);e.Game=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(t){var e=function(){function t(t,e){
void 0===e&&(e=null),this._name=t,this._body=e}return t.prototype.getName=function(){return this._name},t.prototype.setBody=function(t){this._body=t},t.prototype.getBody=function(){return this._body},t.prototype.destroy=function(){this._body=null,this._name=null,delete this._body,delete this._name},t}();t.Notification=e}(e=t.mvc||(t.mvc={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(t){var e=function(){function e(e,o,i){void 0===e&&(e=null),void 0===o&&(o=null),void 0===i&&(i=!0),this._viewComponent=o,this.mediatorName=null,this.app=t.Application.getInstance(),this.mediatorName=e,i&&this.register()}return e.prototype.register=function(){this.app.registerMediator(this)},e.prototype.remove=function(){this.app.removeMediator(this)},e.prototype.onRegister=function(){},e.prototype.onRemoved=function(){},e.prototype.destroy=function(){this.remove()},e.prototype.listNotificationInterests=function(){return[]},e.prototype.handleNotification=function(t){},e.prototype.sendNotification=function(t,e){this.app.sendNotification(t,e)},Object.defineProperty(e.prototype,"viewComponent",{get:function(){return this._viewComponent},set:function(t){this._viewComponent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.mediatorName||e.MEDIATOR_NAME},enumerable:!0,configurable:!0}),e.MEDIATOR_NAME="Mediator",e}();t.Mediator=e}(e=t.mvc||(t.mvc={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(t){var e=function(){function e(e,o){void 0===e&&(e=null),void 0===o&&(o=null),this.modelName=e,this.app=t.Application.getInstance(),this.game=this.app.game,o&&this.setData(o),this.app.registerModel(this)}return e.prototype.getKeyExists=function(t){return null!==this.game.cache.getText(t)},e.prototype.parseData=function(t){return JSON.parse(this.game.cache.getText(t))},e.prototype.setData=function(t){return this.getKeyExists(t)?(this._data=this.parseData(t),this._data):(console.log("cannot set data from key "+t+". Is it in the Phaser cache?"),!1)},e.prototype.getData=function(){return this._data},e.prototype.destroy=function(){this.app.removeModel(this)},Object.defineProperty(e.prototype,"name",{get:function(){return this.modelName||e.MODEL_NAME},enumerable:!0,configurable:!0}),e.MODEL_NAME="Model",e}();t.Model=e}(e=t.mvc||(t.mvc={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(){function o(){if(this._models={},this._mediators={},this._observerMap={},o.instance)throw Error(o.SINGLETON_MSG);o.instance=this,this.initializeApplication()}return o.prototype.initializeApplication=function(){this.game=new t.core.Game({width:800,height:600,parent:"game-container",renderer:Phaser.AUTO,transparent:!1})},o.prototype.registerModel=function(t){this._models[t.name]=t},o.prototype.retrieveModel=function(t){return this._models[t]||null},o.prototype.removeModel=function(t){delete this._models[t.name]},o.prototype.registerMediator=function(t){this._mediators[t.name]=t,this.registerObserver(t),t.onRegister()},o.prototype.retrieveMediator=function(t){return this._mediators[t]||null},o.prototype.removeMediator=function(t){var e=this,o=t.name,i=this._mediators[o];i.listNotificationInterests().forEach(function(t){e.removeObserver(t,i)}),i.onRemoved(),delete this._mediators[o]},o.prototype.registerObserver=function(t){var e=this;t.listNotificationInterests().forEach(function(o){void 0===e._observerMap[o]&&(e._observerMap[o]=[]),e._observerMap[o].push(t)})},o.prototype.removeObserver=function(t,e){var o=null,i=null,n=0;for(o=this._observerMap[t],n=o.length;n--;)if(i=o[n],i===e){o.splice(n,1);break}0==o.length&&delete this._observerMap[t]},o.prototype.sendNotification=function(t,o){var i=new e.Notification(t,o);this._notifyObservers(i),i.destroy(),i=null},o.prototype._notifyObservers=function(t){var e=null,o=t.getName(),i=this._observerMap[o];i&&(e=i.slice(0),e.forEach(function(e){e.handleNotification(t)}))},o.getInstance=function(){return o.instance||(o.instance=new o),o.instance},o.instance=null,o.SINGLETON_MSG="Application singleton already constructed!",o}();e.Application=o}(e=t.mvc||(t.mvc={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(t){var e=function(){function t(t){this.category=t}return t.prototype.trackEvent=function(t,e,i){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),this.active){if(!t)throw new o("No action defined");i?this.ga("send","event",this.category,t,e,i):e?this.ga("send","event",this.category,t,e):this.ga("send","event",this.category,t)}},Object.defineProperty(t.prototype,"active",{get:function(){return window.ga?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ga",{get:function(){return window.ga},enumerable:!0,configurable:!0}),t}();t.AnalyticsManager=e;var o=function(){function t(t){this.message=t,this.name="AnalyticsException"}return t}();t.AnalyticsException=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(e){var o=function(e){function o(){e.call(this),this._audio=[],this._mediator=null,this.app=t.mvc.Application.getInstance(),this.game=this.app.game}return __extends(o,e),o.prototype.init=function(){},o.prototype.preload=function(){this.preloadID&&this.game.asset.loadAssets(this.preloadID)},o.prototype.create=function(){return this.game.asset.allSoundsDecoded()?(this.buildInterface(),this.afterBuildInterface(),void this.startBuild()):void this.game.asset.onLoadCompleteAndAudioDecoded.addOnce(this.create,this)},o.prototype.shutdown=function(){this.removeAudio(),this.removeMediator()},o.prototype.listBuildSequence=function(){return[]},o.prototype.buildInterface=function(){},o.prototype.afterBuildInterface=function(){},o.prototype.startBuild=function(){this.game.sequence.run(this.listBuildSequence(),this,this.buildInterval,this.preAfterBuild,this)},o.prototype.preAfterBuild=function(){this.game["debugger"]&&(this.game["debugger"].selectedObject=null,this.game["debugger"].refresh()),"undefined"!=typeof this.game.transition&&this.game.transition.transitionOut()?(this.game.transition.onTransitionOutComplete.addOnce(this.afterBuild,this),this.game.transition.transitionOut()):this.afterBuild()},o.prototype.afterBuild=function(){},o.prototype.addAudio=function(t){return this._audio||(this._audio=[]),this._audio.push(t),t},o.prototype.removeAudio=function(){var t;if(this._audio)for(;this._audio.length>0;)t=this._audio.pop(),"undefined"!=typeof t&&null!=t&&"undefined"!=typeof t.stop&&("undefined"!=typeof t.onStop&&t.onStop.removeAll(),t.stop())},o.prototype.removeMediator=function(){this._mediator&&(this._mediator.destroy(),this._mediator=null)},Object.defineProperty(o.prototype,"preloadID",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"buildInterval",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"add",{get:function(){return this.game.addToGame},enumerable:!0,configurable:!0}),o}(Phaser.State);e.State=o}(e=t.core||(t.core={}))}(dijon||(dijon={}));var dijon;!function(t){var e;!function(t){var e=function(t){function e(e){void 0===e&&(e=null),t.call(this,e),this._languages={},this._languages.en=this._data}return __extends(e,t),e.prototype.getCopy=function(t,e){return this.getCopyGroup(t)[e]},e.prototype.getCopyGroup=function(t){return this._data[t]},e.prototype.addLanguage=function(t,e){if(!this.getKeyExists(e))throw new Error("cannot add an alternate language from key "+e+". Is it in the Phaser cache?");this._languages[t]=this.parseData(e)},e.prototype.changeLanguage=function(t){if("undefined"==typeof this._languages[t])throw new Error("there is no language "+t);this._data=this._languages[t]},e}(t.Model);t.CopyModel=e}(e=t.mvc||(t.mvc={}))}(dijon||(dijon={}));