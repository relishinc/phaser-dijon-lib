var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};System.register("dijon/interfaces",[],function(t,e){"use strict";e&&e.id;return{setters:[],execute:function(){}}}),System.register("dijon/mvc",["dijon/application"],function(t,e){"use strict";var i,o,n,s,a;e&&e.id;return{setters:[function(t){i=t}],execute:function(){o=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.modelName=e,this.app=i.Application.getInstance(),this.game=this.app.game,t&&this.setData(t),this.app.registerModel(this)}return t.prototype.onRegister=function(){},t.prototype.onRemoved=function(){},t.prototype.getKeyExists=function(t){return null!==this.game.cache.getJSON(t)},t.prototype.setData=function(t){return this.getKeyExists(t)?(this._data=this.game.cache.getJSON(t),this._data):(console.log("Model:: cannot set data from key "+t+". Is it in the Phaser cache?"),!1)},t.prototype.getData=function(){return this._data},t.prototype.destroy=function(){this.app.removeModel(this)},Object.defineProperty(t.prototype,"name",{get:function(){return this.modelName||t.MODEL_NAME},enumerable:!0,configurable:!0}),t.MODEL_NAME="Model",t}(),t("Model",o),n=function(t){function e(e){void 0===e&&(e=null),t.call(this,e),this._languages={},this._languages.en=this._data}return __extends(e,t),e.prototype.getCopy=function(t,e){return this.getCopyGroup(t)[e]},e.prototype.getCopyGroup=function(t){return this._data[t]},e.prototype.addLanguage=function(t,e){if(!this.getKeyExists(e))throw new Error("cannot add an alternate language from key "+e+". Is it in the Phaser cache?");this._languages[t]=this.game.cache.getJSON(e)},e.prototype.changeLanguage=function(t){if("undefined"==typeof this._languages[t])throw new Error("there is no language "+t);this._data=this._languages[t]},Object.defineProperty(e.prototype,"name",{get:function(){return e.MODEL_NAME},enumerable:!0,configurable:!0}),e.MODEL_NAME="copyModel",e}(o),t("CopyModel",n),s=function(){function t(t,e,o){void 0===t&&(t=null),void 0===e&&(e=!0),void 0===o&&(o=null),this._viewComponent=t,this.mediatorName=null,this.app=i.Application.getInstance(),this.game=this.app.game,this.mediatorName=o,e&&this.register()}return t.prototype.register=function(){this.app.registerMediator(this)},t.prototype.remove=function(){this.app.removeMediator(this)},t.prototype.onRegister=function(){},t.prototype.onRemoved=function(){},t.prototype.destroy=function(){this.remove()},t.prototype.listNotificationInterests=function(){return[]},t.prototype.handleNotification=function(t){},t.prototype.sendNotification=function(t,e){this.app.sendNotification(t,e)},Object.defineProperty(t.prototype,"viewComponent",{get:function(){return this._viewComponent},set:function(t){this._viewComponent=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.mediatorName||t.MEDIATOR_NAME},enumerable:!0,configurable:!0}),t.MEDIATOR_NAME="Mediator",t}(),t("Mediator",s),a=function(){function t(t,e){void 0===e&&(e=null),this._name=t,this._body=e}return t.prototype.getName=function(){return this._name},t.prototype.setBody=function(t){this._body=t},t.prototype.getBody=function(){return this._body},t.prototype.destroy=function(){this._body=null,this._name=null},t}(),t("Notification",a)}}}),System.register("dijon/display",["dijon/application"],function(t,e){"use strict";var i,o,n,s,a,r,h;e&&e.id;return{setters:[function(t){i=t}],execute:function(){o=function(t){function e(e,o,n,s,a,r){void 0===a&&(a="dSprite"),void 0===r&&(r=null),t.call(this,i.Application.getInstance().game,e,o,n,s),this.name=a,this._hasComponents=!1,this._componentKeys=[],this._components={},this.addComponents=function(t){if("undefined"==typeof t.length)throw new Error("Dijon.UIGroup components must be an array");for(;t.length>0;)this.addComponent(t.shift())},r&&this.addComponents(r)}return __extends(e,t),e.prototype.update=function(){this._hasComponents&&this.updateComponents()},e.prototype.destroy=function(){this.removeAllComponents(),t.prototype.destroy.call(this)},e.prototype.init=function(){},e.prototype.buildInterface=function(){},e.prototype._updateComponentKeys=function(){this._componentKeys=Object.keys(this._components),this._hasComponents=this._componentKeys.length>0},e.prototype.addComponent=function(t){return t.setOwner(this),t.init(),t.buildInterface(),this._components[t.name]=t,this._updateComponentKeys(),t},e.prototype.updateComponents=function(){var t=this;this._componentKeys.forEach(function(e){t.updateComponent(e)})},e.prototype.updateComponent=function(t){this._components[t].update()},e.prototype.removeAllComponents=function(){for(;this._componentKeys.length>0;)this.removeComponent(this._componentKeys.pop())},e.prototype.removeComponent=function(t){"undefined"!=typeof this._components[t]&&(this._components[t].destroy(),this._components[t]=null,delete this._components[t],this._updateComponentKeys())},e.prototype.flatten=function(t){var e=this;void 0===t&&(t=0),0===t?this.cacheAsBitmap=!0:this.game.time.events.add(t,function(){e.cacheAsBitmap=!0},this)},e.prototype.unFlatten=function(){this.cacheAsBitmap=null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.texture.baseTexture.resolution},enumerable:!0,configurable:!0}),e}(Phaser.Sprite),t("Sprite",o),n=function(t){function e(e,i,o,n,s){t.call(this,e,i,null,null,o),this.setSize(n,s)}return __extends(e,t),e.prototype.init=function(){this.inputEnabled=!0},e.prototype.buildInterface=function(){this._addHitRect()},e.prototype._addHitRect=function(){this._hitWidth>0&&this._hitHeight>0&&(this.hitArea=new Phaser.Rectangle(0,0,this._hitWidth,this._hitHeight))},e.prototype.setSize=function(t,e){this._hitWidth=t||0,this._hitHeight=e||0,this._addHitRect()},e}(o),t("InvisibleButton",n),s=function(t){function e(e,o,n,s,a,r,h){void 0===e&&(e=0),void 0===o&&(o=0),void 0===n&&(n="dGroup"),void 0===s&&(s=!1),void 0===a&&(a=null),t.call(this,i.Application.getInstance().game,null,n,s,r,h),this.name=n,this._hasComponents=!1,this._componentKeys=[],this._components={},this._mediator=null,this.addComponents=function(t){if("undefined"==typeof t.length)throw new Error("Dijon.UIGroup components must be an array");for(;t.length>0;)this.addComponent(t.shift())},this.position.set(e,o),s||this.game.add.existing(this),a&&this.addComponents(a)}return __extends(e,t),e.prototype.update=function(){t.prototype.update.call(this),this._hasComponents&&this.updateComponents()},e.prototype.destroy=function(){this.removeAllComponents(),this.removeMediator(),t.prototype.destroy.call(this)},e.prototype.init=function(){},e.prototype.buildInterface=function(){},e.prototype._updateComponentKeys=function(){this._componentKeys=Object.keys(this._components),this._hasComponents=this._componentKeys.length>0},e.prototype.addComponent=function(t){return t.setOwner(this),t.init(),t.buildInterface(),this._components[t.name]=t,this._updateComponentKeys(),t},e.prototype.updateComponents=function(){var t=this;this._componentKeys.forEach(function(e){t.updateComponent(e)})},e.prototype.updateComponent=function(t){this._components[t].update()},e.prototype.removeAllComponents=function(){for(;this._componentKeys.length>0;)this.removeComponent(this._componentKeys.pop())},e.prototype.removeComponent=function(t){"undefined"!=typeof this._components[t]&&(this._components[t].destroy(),this._components[t]=null,delete this._components[t],this._updateComponentKeys())},e.prototype.flatten=function(t){var e=this;void 0===t&&(t=0),0===t?this.cacheAsBitmap=!0:this.game.time.events.add(t,function(){e.cacheAsBitmap=!0},this)},e.prototype.unFlatten=function(){this.cacheAsBitmap=null},e.prototype.removeMediator=function(){this._mediator&&(this._mediator.destroy(),this._mediator=null)},Object.defineProperty(e.prototype,"addInternal",{get:function(){return this.game.add.targetGroup=this,this.game.add},enumerable:!0,configurable:!0}),e}(Phaser.Group),t("Group",s),a=function(t){function e(o,n,s,a,r,h,d,u,p,l,c){void 0===s&&(s=""),void 0===r&&(r=e.DEFAULT_FONT_SIZE),void 0===h&&(h=e.DEFAULT_FONT_COLOR),void 0===d&&(d="left"),void 0===u&&(u=!1),void 0===p&&(p=0),void 0===l&&(l=0),void 0===c&&(c=null),t.call(this,i.Application.getInstance().game,o,n,s,e._addSettings({font:r+"px "+a,fill:h,align:d,wordWrap:u,wordWrapWidth:p},c)),this.lineSpacing=l,this.onAnimationComplete=new Phaser.Signal,this._canUpdate=!1,this._textToAnimate=[],this.stopAnimating=function(){this._canUpdate=!1,this._textToAnimate=null,this.game.time.events.remove(this._delayTimer),this.game.time.events.remove(this._repeatTimer)},this.roundPixel=function(){this.position.set(Math.round(this.x),Math.round(this.y))},this.text=s.replace(/'/g,"'"),this._lowercaseText=this.text.toLowerCase(),this.setResolution()}return __extends(e,t),e.prototype.setText=function(e){return t.prototype.setText.call(this,e),this._lowercaseText=this.text.toLowerCase(),this.setResolution(),this},e.prototype.setResolution=function(){this.game&&this.game.device.cocoonJS&&this.game.device.cocoonJS&&(this.resolution=this.game.resolution*this.game.resolution)},e.prototype._startTextAnimation=function(){this._canUpdate=!0,this._repeatTimer=this.game.time.events.repeat(100*this._letterTime,this._textLength,this._updateTextAnimation,this)},e.prototype._updateTextAnimation=function(){if(!this._canUpdate||!this._textToAnimate)return!1;var t=this._textLength-this._textToAnimate.length;this.addColor(this.style.fill,t),this.addColor("rgba(0,0,0,0)",t+1),this._textToAnimate.shift(),0===this._textToAnimate.length&&this.onAnimationComplete.dispatch()},e.prototype.setColor=function(t){return this.highlightPhrase(this.text,t,!1)},e.prototype.resetColor=function(){return this.highlightPhrase(this.text,this.style.fill,!1)},e.prototype.highlightPhrase=function(t,e,i){void 0===i&&(i=!1);var o=i?this.text:this._lowercaseText;t=i?t:t.toLowerCase();for(var n=t.length,s=o.indexOf(t),a=s+n;a>=s;)this.addColor(e,s),s++;this.addColor(this.style.fill,a)},e.prototype.animate=function(t,e){void 0===t&&(t=.1),void 0===e&&(e=0),this.game.time.events.remove(this._delayTimer),this.game.time.events.remove(this._repeatTimer),this._letterTime=t,this._textLength=this.text.length,this._textToAnimate=this.text.split("");for(var i=0,o=this._textLength;o>=i;)this.addColor("rgba(0,0,0,0)",i),i++;this._delayTimer=this.game.time.events.add(e*Phaser.Timer.SECOND,this._startTextAnimation,this)},e._addSettings=function(t,e){if(!e)return t;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},Object.defineProperty(e.prototype,"realHeight",{get:function(){return this.scale.y*this.texture.frame.height/this.game.resolution},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realWidth",{get:function(){return this.scale.x*this.texture.frame.width/this.game.resolution},enumerable:!0,configurable:!0}),e.DEFAULT_FONT_SIZE=12,e.DEFAULT_FONT_COLOR="#000000",e.DEFAULT_FONT="Helvetica Neue, Arial",e.GLOBAL_PADDING_X=0,e.GLOBAL_PADDING_Y=0,e}(Phaser.Text),t("Text",a),r=function(){function t(){this.game=i.Application.getInstance().game,this.name="Component"}return t.prototype.setOwner=function(t){this.owner=t},t.prototype.init=function(){},t.prototype.buildInterface=function(){},t.prototype.update=function(){},t.prototype.destroy=function(){},t}(),t("Component",r),h=function(t){function e(e,i,o,n,s,a,r,h,d,u,p){void 0===r&&(r=!0),t.call(this,e,i),this.key=s,this.texturePath=a,this.fillMiddle=r,this.topHeight=h,this.rightWidth=d,this.bottomHeight=u,this.leftWidth=p,this._interactiveBacking=null,this._inputEnabled=!1,this._currentBounds=null,this.__width=Math.round(o),this.__height=Math.round(n),this._build(),this.game.time.events.add(10,this._flatten,this)}return __extends(e,t),e.prototype._build=function(){this._inputLayer=this.add(this.game.add.group()),this._displayLayer=this.add(this.game.add.group()),this.tl=this._displayLayer.add(this.game.add.image(0,0,this.key,this.texturePath+"/tl")),this.tr=this._displayLayer.add(this.game.add.image(this.__width,0,this.key,this.texturePath+"/tr")),this.t=this._displayLayer.add(this.game.add.tileSprite(this.tl.getBounds().width,0,this.__width-this.tl.getBounds().width-this.tr.getBounds().width,this.topHeight||this.tl.getBounds().height,this.key,this.texturePath+"/t")),this.l=this._displayLayer.add(this.game.add.tileSprite(0,this.tl.getBounds().height,this.leftWidth||this.tl.getBounds().width,100,this.key,this.texturePath+"/l")),this.bl=this._displayLayer.add(this.game.add.image(0,this.__height,this.key,this.texturePath+"/bl")),this.l.height=this.__height-this.tl.getBounds().height-this.bl.getBounds().height,this.b=this._displayLayer.add(this.game.add.tileSprite(this.bl.getBounds().width,this.__height,100,this.bottomHeight||this.bl.getBounds().height,this.key,this.texturePath+"/b")),this.br=this._displayLayer.add(this.game.add.image(this.__width,this.__height,this.key,this.texturePath+"/br")),this.b.width=this.__width-this.bl.getBounds().width-this.br.getBounds().width,this.r=this._displayLayer.add(this.game.add.tileSprite(this.__width,this.tr.getBounds().height,this.rightWidth||this.tr.getBounds().width,this.__height-this.tl.getBounds().height-this.br.getBounds().height,this.key,this.texturePath+"/r")),this.tr.setPivot("tr"),this.r.setPivot("tr"),this.br.setPivot("br"),this.b.setPivot("bl"),this.bl.setPivot("bl"),this.fillMiddle&&(this.tile=this._displayLayer.add(this.game.add.tileSprite(this.tl.getBounds().width-1,this.tl.getBounds().height-1,this.__width-this.tl.getBounds().width-this.tr.getBounds().width+2,this.__height-this.tl.getBounds().height-this.br.getBounds().height+4,this.key,this.texturePath+"/tile")),this.sendToBack(this.tile))},e.prototype._addInteractiveBacking=function(){var t=this.game.add.graphics();t.beginFill(16711680,0),t.drawRect(this.x,this.y,this.__width,this.__height),t.endFill(),this._interactiveBacking=this._inputLayer.add(this.game.add.image(0,0,t.generateTexture())),this._interactiveBacking.inputEnabled=!0,this.game.world.remove(t)},e.prototype._setSize=function(){this._unflatten(),this.t.width=this.b.width=this.__width-this.tl.getBounds().width-this.tr.getBounds().width,this.r.x=this.tr.x=this.br.x=this.__width,this.l.height=this.r.height=this.__height-this.tr.getBounds().height-this.bl.getBounds().height,this.bl.y=this.b.y=this.br.y=this.__height,this.fillMiddle&&(this.tile.width=this.__width-this.tr.getBounds().width-this.tl.getBounds().width+4,this.tile.height=this.__height-this.tl.getBounds().height-this.bl.getBounds().height+4),this._interactiveBacking.width=this.__width,this._interactiveBacking.height=this.__height,this.game.time.events.add(10,this._flatten,this)},e.prototype._addInput=function(){this._interactiveBacking||this._addInteractiveBacking()},e.prototype._removeInput=function(){this._interactiveBacking&&(this._interactiveBacking.inputEnabled=!1)},e.prototype._unflatten=function(){this._displayLayer.cacheAsBitmap=null},e.prototype._flatten=function(){this._displayLayer.cacheAsBitmap=!0},Object.defineProperty(e.prototype,"inputEnabled",{set:function(t){this._inputEnabled=t,this._inputEnabled?this._addInput():this._removeInput()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this._interactiveBacking&&this._interactiveBacking.inputEnabled?this._interactiveBacking.events:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"input",{get:function(){return this._interactiveBacking.input},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hSize",{get:function(){return this.__width},set:function(t){this.__width=t,this._setSize()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vSize",{get:function(){return this.__height},set:function(t){this.__height=t,this._setSize()},enumerable:!0,configurable:!0}),e.prototype.setSize=function(t,e){this.__width=t,this.__height=e,this._setSize()},e}(s),t("NineSliceImage",h)}}}),System.register("dijon/utils",["dijon/application","dijon/display"],function(t,e){"use strict";var i,o,n,s,a,r,h,d;e&&e.id;return{setters:[function(t){i=t},function(t){o=t}],execute:function(){n=function(){function t(){}return t.isNumber=function(t){return+t===+t},t}(),t("Util",n),s=function(){function t(){}return t.log=function(e){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return t.enabled?(e&&e.constructor&&i.unshift(e.constructor.toString().match(/\w+/g)[1]+" ::"),console.log.apply(console,i)):void 0},t.enabled=!0,t}(),t("Logger",s),a=function(){function t(){}return Object.defineProperty(t,"mobile",{get:function(){return t.mobileOS!==t.UNKNOWN},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cocoon",{get:function(){return"undefined"!=typeof navigator.isCocoonJS},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mobileOS",{get:function(){var e=window.navigator.userAgent||window.navigator.vendor||window.opera;return e.match(/iPad/i)||e.match(/iPhone/i)||e.match(/iPod/i)?t.IOS:e.match(/Android/i)?t.ANDROID:t.UNKNOWN},enumerable:!0,configurable:!0}),Object.defineProperty(t,"browser",{get:function(){var t=navigator.userAgent.toLowerCase();return{firefox:t.indexOf("firefox")>-1,ie:t.indexOf("ie")>-1,safari:t.indexOf("safari")>-1,chrome:t.indexOf("chrome")>-1}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pixelRatio",{get:function(){return void 0!==typeof window.devicePixelRatio?window.devicePixelRatio:1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"customPixelRatio",{get:function(){return t.pixelRatio>=1.5?2:1},enumerable:!0,configurable:!0}),t.IOS="iOS",t.ANDROID="android",t.UNKNOWN="unknown",t}(),t("Device",a),r=function(){function t(){}return Object.defineProperty(t,"game",{get:function(){return i.Application.getInstance().game},enumerable:!0,configurable:!0}),t.rect=function(e,i,o,n,s,a,r,h,d){void 0===e&&(e=100),void 0===i&&(i=100),void 0===o&&(o=16777215),void 0===n&&(n=1),void 0===s&&(s=!0),void 0===a&&(a=16777215),void 0===r&&(r=1),void 0===h&&(h=1),void 0===d&&(d=!1);var u=t.game.add.graphics(0,0);s&&u.beginFill(o,n),d&&(u.lineWidth=r,u.lineStyle(r,a,h)),u.drawRect(0,0,e,i);var p=u.generateTexture();return t.game.world.remove(u),p},t.roundedRect=function(e,i,o,n,s,a,r,h,d,u){void 0===e&&(e=100),void 0===i&&(i=100),void 0===o&&(o=10),void 0===n&&(n=16777215),void 0===s&&(s=1),void 0===a&&(a=!0),void 0===r&&(r=16777215),void 0===h&&(h=1),void 0===d&&(d=1),void 0===u&&(u=!1);var p=t.game.add.graphics(0,0);a&&p.beginFill(n,s),u&&(p.lineWidth=h,p.lineStyle(h,r,d)),p.drawRoundedRect(0,0,e,i,o);var l=p.generateTexture();return t.game.world.remove(p),l},t.square=function(e,i,o,n,s,a,r,h){return void 0===e&&(e=100),void 0===i&&(i=16777215),void 0===o&&(o=1),void 0===n&&(n=!0),void 0===s&&(s=16777215),void 0===a&&(a=1),void 0===r&&(r=1),void 0===h&&(h=!1),t.rect(e,e,i,o,n,s,a,r,h)},t.circle=function(e,i,o,n,s,a,r,h){void 0===e&&(e=100),void 0===i&&(i=16777215),void 0===o&&(o=1),void 0===n&&(n=!0),void 0===s&&(s=16777215),void 0===a&&(a=1),void 0===r&&(r=1),void 0===h&&(h=!1);var d=t.game.add.graphics(0,0);n&&d.beginFill(i,o),h&&(d.lineWidth=a,d.lineStyle(a,s,r)),d.drawCircle(0,0,e);var u=d.generateTexture();return t.game.world.remove(d),u},t.ellipse=function(e,i,o,n,s,a,r,h,d){void 0===e&&(e=50),void 0===i&&(i=100),void 0===o&&(o=16777215),void 0===n&&(n=1),void 0===s&&(s=!0),void 0===a&&(a=16777215),void 0===r&&(r=1),void 0===h&&(h=1),void 0===d&&(d=!1);var u=t.game.add.graphics(0,0);s&&u.beginFill(o,n),d&&(u.lineWidth=r,u.lineStyle(r,a,h)),u.drawEllipse(0,0,.5*e,.5*i);var p=u.generateTexture();return t.game.world.remove(u),p},t}(),t("Textures",r),h=function(){function t(){}return Object.defineProperty(t,"game",{get:function(){return i.Application.getInstance().game},enumerable:!0,configurable:!0}),t.image=function(e,i,o,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="");var s=new Phaser.Image(t.game,e,i,o);return s.name=n,s},t.button=function(e,i,n,s,a,h,d,u,p,l,c){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=100),void 0===s&&(s=50),void 0===a&&(a=!1),void 0===h&&(h="button"),void 0===d&&(d=null),void 0===u&&(u=null),void 0===p&&(p=16777215),void 0===l&&(l=16711680),void 0===c&&(c=65280);var g=new Phaser.Sprite(t.game,e,i),f=new o.Text(.5*n,.55*s," "+h+" ","Arial",a?25:.6*s,"#000000");f.centerPivot(),f.name="Label",a&&(n=f.width+10,s=f.height+10,f.position.set(.5*n,.55*s));var m=t.image(0,0,r.roundedRect(n,s,10,p),"Up"),_=t.image(0,0,r.roundedRect(n,s,10,l),"Over"),y=t.image(0,0,r.roundedRect(n,s,10,c),"Down");return _.visible=!1,y.visible=!1,g.addChild(m),g.addChild(_),g.addChild(y),g.addChild(f),g.inputEnabled=!0,g.input.useHandCursor=!0,g.events.onInputUp.add(function(){y.visible=!1,_.visible=!1,m.visible=!0,d&&d.call(u)}),g.events.onInputDown.add(function(){y.visible=!0,_.visible=!1,m.visible=!1}),g.events.onInputOver.add(function(){y.visible=!1,_.visible=!0,m.visible=!1}),g.events.onInputOut.add(function(){y.visible=!1,_.visible=!1,m.visible=!0}),g.getBounds=function(){return new PIXI.Rectangle(0,0,m.width,m.height)},g},t}(),t("Placeholders",h),d=function(){function t(){}return t.ASSET_MANAGER_DATA_SET="dijonAssetManagerDataSet",t.ASSET_MANAGER_ASSETS_CLEARED="dijonAssetManagerAssetsCleared",t.MOUSE_LEAVE_GLOBAL="mouseOutGlobal",t.MOUSE_ENTER_GLOBAL="mouseEnterGlobal",t}(),t("Notifications",d)}}}),System.register("dijon/core",["dijon/application","dijon/utils","dijon/display"],function(t,e){"use strict";var i,o,n,s,a,r,h,d,u,p,l,c,g;e&&e.id;return{setters:[function(t){i=t},function(t){o=t},function(t){n=t}],execute:function(){s=function(){function t(t,e){void 0===t&&(t=!0),void 0===e&&(e=null),this.enabled=t,this.category=e}return t.prototype.trackEvent=function(t,e,i){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),this.active&&this.enabled){if(!t)throw new a("No action defined");i?this.ga("send","event",this.category,t,e,i):e?this.ga("send","event",this.category,t,e):this.ga("send","event",this.category,t)}},t.prototype.trackOmnitureEvent=function(t,e,i){return this.enabled?"undefined"==typeof window.trackFlashEvent?!1:void window.trackFlashEvent(t,e,i):void 0},Object.defineProperty(t.prototype,"active",{get:function(){return window.ga?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ga",{get:function(){return window.ga},enumerable:!0,configurable:!0}),t}(),t("AnalyticsManager",s),a=function(){function t(t){this.message=t,this.name="AnalyticsException"}return t}(),t("AnalyticsException",a),r=function(){function t(){this._data={},this._baseURL="",this._pathObj={},this._assetPath=null,this._dataPath=null,this._spriteSheetPath=null,this._imgPath=null,this._fontPath=null,this._bitmapFontPath=null,this._physicsPath=null,this._audioSpritePath=null,this._soundPath=null,this._soundDecodingModifier=2,this._res=1,this._resolution=null,this._loadData={},this._autoLoadData={},this._completedLoads={},this._requiredData={},this._currentAssetList=null,this._hasFiles=!1,this._soundsToDecode=[],this._isLoadingQueue=!1,this._fileCompleteProgress=0,this._maxPercent=100,this._numSounds=0,this._soundsDecoded=0,this._cacheBustVersion="",this.onLoadStart=new Phaser.Signal,this.onFileStart=new Phaser.Signal,this.onFileComplete=new Phaser.Signal,this.onLoadComplete=new Phaser.Signal,this.onLoadCompleteAndAudioDecoded=new Phaser.Signal,this.onBackgroundLoadStart=new Phaser.Signal,this.onBackgroundFileStart=new Phaser.Signal,this.onBackgroundFileComplete=new Phaser.Signal,this.onBackgroundLoadComplete=new Phaser.Signal,this.onBackgroundLoadCompleteAndAudioDecoded=new Phaser.Signal,this._init()}return t.prototype._init=function(){this.app=i.Application.getInstance(),this.game=this.app.game,this.baseURL="",this.paths=null,this.resolution=this.game.resolution},t.prototype._parseAssetList=function(t,e){var i=this;this._autoLoadData[t]=e.autoload,this._requiredData[t]=e.required,this._loadData[t]=[],e.assets.forEach(function(e){i._loadData[t].push(e)})},t.prototype._loadAssets=function(t){var e,i=this._loadData[t];for(e=0;e<i.length;e++)this._loadAsset(i[e])},t.prototype._backgroundLoadStart=function(){this.onBackgroundLoadStart.dispatch()},t.prototype._backgroundFileComplete=function(t,e,i,o){this.game.cache.checkKey(Phaser.Cache.IMAGE,e)&&this._setBaseTextureResolution(this.game.cache.getPixiBaseTexture(e)),this._fileCompleteProgress=t,this.onBackgroundFileComplete.dispatch(t,e,i,o)},t.prototype._backgroundLoadComplete=function(){this.game.load.onFileComplete.remove(this._backgroundFileComplete,this),this.onBackgroundLoadComplete.dispatch(),this._checkSoundDecoding(this.onBackgroundLoadCompleteAndAudioDecoded)},t.prototype._gameLoadStart=function(){this.onLoadStart.dispatch()},t.prototype._gameFileStart=function(){this.onFileStart.dispatch()},t.prototype._gameFileComplete=function(t,e,i,o){this.game.cache.checkKey(Phaser.Cache.IMAGE,e)&&this._setBaseTextureResolution(this.game.cache.getPixiBaseTexture(e)),this._fileCompleteProgress=t,this.onFileComplete.dispatch(this.getLoadProgress(),e,i,o)},t.prototype._setBaseTextureResolution=function(t){t&&t.source.src.indexOf("@"+this.resolution+"x")>=0&&(t.resolution=this.resolution)},t.prototype._gameLoadComplete=function(){this._completedLoads[this._currentAssetList]=!0,this.onLoadComplete.dispatch(),this.game.load.onFileStart.remove(this._gameFileStart,this),this.game.load.onFileComplete.remove(this._gameFileComplete,this),this._checkSoundDecoding(this.onLoadCompleteAndAudioDecoded)},t.prototype._checkSoundDecoding=function(t){var e,i,o;if(this._soundsToDecode&&this._soundsToDecode.length>0)for(i=0;i<this._soundsToDecode.length;i++)o=this._soundsToDecode[i].isAudioSprite,e=this.game.add.sound(this._soundsToDecode[i].url),e.__isAudioSprite=o,e.eventToDispatch=t,e.onDecoded.addOnce(this._onSoundDecoded,this);else t.dispatch()},t.prototype._onSoundDecoded=function(t){var e=this._soundsToDecode.indexOf(t.key);this._soundsToDecode.splice(e,1),"undefined"!=typeof this.game.audio&&"undefined"!=typeof this.game.audio.addAudio&&(t.__isAudioSprite&&this.game.add.audioSprite(t.key),this.game.audio.addAudio(t.key,t.__isAudioSprite)),this._soundsDecoded++,this._maxPercent=100-this._numSounds*this.soundDecodingModifier+this._soundsDecoded*this.soundDecodingModifier,this._gameFileComplete(100),0===this._soundsToDecode.length&&t.eventToDispatch.dispatch()},t.prototype._getAssetKey=function(t){if(t.indexOf(".")<0)return t;var e=t.split(".");return e.pop(),e.join("")},t.prototype._getExtension=function(t){return t.split(".").pop()},t.prototype._getResolution=function(e){var i="";return"string"==typeof e&&(e=parseFloat(e)),void 0===e&&(e=this.resolution),e>1.5&&(i=t.RESOLUTION_2X),i},t.prototype._loadAsset=function(e){var i=e.type,o=e.url||e.key;switch(i){case t.ASSET_LIST:this._loadAssets(e.id);break;case t.SOUND:this.loadSound(o,e.extensions);break;case t.AUDIO_SPRITE:this.loadAudioSprite(o,e.extensions);break;case t.IMAGE:this.loadImage(o,this._getResolution(e.resolution));break;case t.ATLAS:this.loadAtlas(o,this._getResolution(e.resolution));break;case t.TEXT:this.loadText(o);break;case t.JSON:this.loadJSON(o);break;case t.TILEMAP:this.loadTilemap(o);break;case t.TILEDMAP:this.loadTiledmap(o,e.assets);break;case t.PHYSICS:this.loadPhysics(o)}},t.prototype._parseData=function(){var t;for(t in this._data)this._parseAssetList(t,this._data[t])},t.prototype._getCacheBustedUrl=function(t){return void 0===this._cacheBustVersion||""===this._cacheBustVersion?t:t+"?v="+this._cacheBustVersion},t.prototype.loadText=function(t){var e=this._getAssetKey(t);return this.game.load.text(e,this._getCacheBustedUrl(this._dataPath+"/"+t))},t.prototype.loadJSON=function(t){return t=this._getAssetKey(t),this.game.load.json(t,this._getCacheBustedUrl(this._dataPath+"/"+t+".json"))},t.prototype.loadTilemap=function(t){return t=this._getAssetKey(t),this.game.load.tilemap(t,this._getCacheBustedUrl(this._dataPath+"/tilemap/"+t+".json"),null,Phaser.Tilemap.TILED_JSON)},t.prototype.loadTiledmap=function(e,i){var o=this;if(void 0===Phaser.Plugin.Tiled)return console.log("tiledmap requires the phaser-tiled plugin from https://github.com/englercj/phaser-tiled"),null;var n=Phaser.Plugin.Tiled.utils.cacheKey;this.game.load.tiledmap(n(e,"tiledmap"),this._getCacheBustedUrl(this._dataPath+"/tilemap/"+e+".json"),null,Phaser.Tilemap.TILED_JSON),i.forEach(function(i){switch(i.type){case t.TILEDMAP_TILESET:case t.TILEDMAP_LAYER:o.loadTiledmapImage(e,i.type,i)}})},t.prototype.loadTiledmapImage=function(t,e,i){var o=Phaser.Plugin.Tiled.utils.cacheKey,n="",s=this._getAssetKey(i.url),a=o(t,"tileset",s);"string"!=typeof i.resolution&&(n=this._getResolution(i.resolution));var r=this._getAssetKey(s+n+"."+this._getExtension(i.url));console.log(i.url,a),this.game.load.image(a,this._getCacheBustedUrl(this._spriteSheetPath+"/"+r+".png"))},t.prototype.loadPhysics=function(t){return t=this._getAssetKey(t),this.game.load.physics(t,this._getCacheBustedUrl(this._physicsPath+"/"+t+".json"))},t.prototype.loadAtlas=function(t,e){return"string"!=typeof e&&(e=this._getResolution(e)),this.game.cache.checkImageKey(t)?t:this.game.load.atlasJSONHash(t,this._getCacheBustedUrl(this._spriteSheetPath+"/"+t+e+".png"),this._getCacheBustedUrl(this._spriteSheetPath+"/"+t+e+".json"))},t.prototype.loadImage=function(t,e){"string"!=typeof e&&(e=this._getResolution(e));var i=this._getAssetKey(t);return this.game.cache.checkImageKey(i)?i:(t=i+e+"."+this._getExtension(t),this.game.load.image(i,this._getCacheBustedUrl(this._imgPath+"/"+t)))},t.prototype.loadBitmapFont=function(t,e){"string"!=typeof e&&(e=this._getResolution(e)),this.game.load.bitmapFont(t,this._getCacheBustedUrl(this._bitmapFontPath+"/"+t+e+".png"),this._getCacheBustedUrl(this._bitmapFontPath+"/"+t+e+".json"))},t.prototype.loadAudio=function(t,e,i){var o,n;if(!this.game.cache.checkSoundKey(t)||!this.game.cache.getSound(t).isDecoded){if("undefined"==typeof o&&(o="sound"),e.indexOf(",")>=0&&(e=e.split(",")),this.game.device.iOS&&-1===e.indexOf("m4a")&&e.unshift("m4a"),"object"==typeof e){n=[];for(var s=0;s<e.length;s++)n.push(this._getCacheBustedUrl((i?this._audioSpritePath:this._soundPath)+"/"+t+"."+e[s]))}else n=this._getCacheBustedUrl((i?this._audioSpritePath:this._soundPath)+"/"+o+"/"+t+"."+e);i?this.game.load.audiosprite(t,n,this._audioSpritePath+"/"+t+".json"):this.game.load.audio(t,n),this._soundsToDecode.push({url:t,isAudioSprite:i})}},t.prototype.loadSound=function(t,e){return this.loadAudio(t,e,!1)},t.prototype.loadAudioSprite=function(t,e){return this.loadAudio(t,e,!0)},t.prototype.loadAssets=function(t,e){if(void 0===e&&(e=!1),this._currentAssetList=t,this.game.load.onFileComplete.remove(this._backgroundFileComplete,this),this.game.load.onFileComplete.remove(this._gameFileComplete,this),this._hasFiles=!1,this._soundsToDecode=[],"undefined"!=typeof this._data){if("undefined"==typeof this._data[t]||this._data[t].length<1)return console.log("no preload data registered for ",t);if(this._loadAssets(t),this._hasFiles=this.game.load.totalQueuedFiles()>0,e?(this.game.load.onLoadStart.addOnce(this._backgroundLoadStart,this),this.game.load.onFileComplete.add(this._backgroundFileComplete,this),this.game.load.onLoadComplete.addOnce(this._backgroundLoadComplete,this)):(this.game.load.onLoadStart.addOnce(this._gameLoadStart,this),this.game.load.onFileStart.add(this._gameFileStart,this),this.game.load.onFileComplete.add(this._gameFileComplete,this),this.game.load.onLoadComplete.addOnce(this._gameLoadComplete,this)),!this._hasFiles)return this._gameLoadStart(),this._gameFileComplete(100),void this._gameLoadComplete();this._numSounds=this._soundsToDecode.length,this._soundsDecoded=0,this._maxPercent=100-this._numSounds*this.soundDecodingModifier,e&&this.game.load.start()}},t.prototype.loadQueue=function(){if(!this._isLoadingQueue){if("undefined"==typeof this._data)return console.log("no preload queue to load");var t,e,i;for(e in this._data)if(this._autoLoadData[e])for(t=this._data[e],
i=0;i<t.length;i++)this._loadAsset(t[i]);this.game.load.start(),this._isLoadingQueue=!0,this.game.load.onLoadStart.addOnce(this._backgroundLoadStart,this),this.game.load.onFileComplete.add(this._backgroundFileComplete,this),this.game.load.onLoadComplete.addOnce(this._backgroundLoadComplete,this)}},t.prototype.getLoadProgress=function(){var t=this._fileCompleteProgress*this._maxPercent/100;return t},t.prototype.allSoundsDecoded=function(){return 0===this._soundsToDecode.length},t.prototype.setData=function(t){this._data=t,this._loadData={},this._parseData(),this.sendNotification(o.Notifications.ASSET_MANAGER_DATA_SET,this._data)},t.prototype.clearAssets=function(t,e,i,n,s,a){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!0),void 0===a&&(a=!0);var r=this._data[t];if(console.log("clearing: ",t),!r||"undefined"==typeof r||r.length<1)return console.log("no assets",r);for(var h=0;h<r.length;h++)this.clearAsset(r[h],e,i,n,s,a);this._completedLoads[t]=!1,this.sendNotification(o.Notifications.ASSET_MANAGER_ASSETS_CLEARED,t)},t.prototype.clearAsset=function(e,i,o,n,s,a){void 0===i&&(i=!0),void 0===o&&(o=!0),void 0===n&&(n=!0),void 0===s&&(s=!0),void 0===a&&(a=!0);var r=e.type,h=e.url,d=e.required;if(d)return void console.log("the "+r+" asset: "+h+" is required and will not be cleared");switch(r){case t.AUDIO:i&&(this.game.sound.removeByKey(h),this.game.cache.removeSound(h));break;case t.IMAGE:n&&(this.game.cache.removeImage(h),PIXI.BaseTextureCache[h].destroy());break;case t.ATLAS:o&&(this.game.cache.removeImage(h),PIXI.BaseTextureCache[h].destroy(),this.game.cache.removeXML(h));break;case t.TEXT:s&&this.game.cache.removeText(h);break;case t.JSON:a&&this.game.cache.removeJSON(h);break;case t.PHYSICS:a&&this.game.cache.removePhysics(h)}},t.prototype.hasLoadedAssets=function(t){return this._completedLoads[t]===!0},t.prototype.sendNotification=function(t,e){return this.app.sendNotification(t,e)},Object.defineProperty(t.prototype,"baseURL",{set:function(t){t&&void 0!==t&&"/"!==t.charAt(t.length-1)&&(t+="/"),this._baseURL=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paths",{set:function(t){this._pathObj=t||{},this._assetPath=this._baseURL+(this._pathObj.assetPath||"assets"),this._dataPath=this._baseURL+(this._pathObj.dataPath||"assets/data"),this._spriteSheetPath=this._baseURL+(this._pathObj.spritesheetPath||"assets/img/spritesheets"),this._imgPath=this._baseURL+(this._pathObj.imgPath||"assets/img"),this._fontPath=this._baseURL+(this._pathObj.fontPath||"assets/fonts"),this._bitmapFontPath=this._baseURL+(this._pathObj.bitmapFontPath||"assets/fonts/bitmap"),this._audioSpritePath=this._baseURL+(this._pathObj.audioSpritePath||"assets/audio/sprite"),this._soundPath=this._baseURL+(this._pathObj.soundPath||"assets/audio/sound"),this._physicsPath=this._baseURL+(this._pathObj.physicsPath||"assets/data/physics")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._res},set:function(e){void 0===e&&(e=this.game.resolution),this._res=e,this._resolution="",this._res>1.5&&(this._resolution=t.RESOLUTION_2X)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"soundDecodingModifier",{get:function(){return this._soundDecodingModifier},set:function(t){void 0===t&&(t=2),this._soundDecodingModifier=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheBustVersion",{set:function(t){this._cacheBustVersion=""+t},enumerable:!0,configurable:!0}),t.AUDIO="audio",t.SOUND="sound",t.AUDIO_SPRITE="audioSprite",t.IMAGE="image",t.ATLAS="atlas",t.TEXT="text",t.JSON="json",t.TILEMAP="tilemap",t.TILEDMAP="tiledmap",t.TILEDMAP_TILESET="tileset",t.TILEDMAP_LAYER="layer",t.PHYSICS="physics",t.ASSET_LIST="assetList",t.RESOLUTION_2X="@2x",t.RESOLUTION_3X="@3x",t}(),t("AssetManager",r),h=function(){function t(){this._defaultVolume=1,this._sprites={},this._sounds={},this._markerLookup={},this.game=i.Application.getInstance().game}return t.prototype._addAudio=function(t,e){return void 0===e&&(e=!1),e===!0?this._parseAudioSprite(t,this.game.add.audioSprite(t)):this._allowMultiple(this.game.add.sound(t))},t.prototype._parseAudioSprite=function(t,e){for(var i in e.sounds)this._allowMultiple(e.sounds[i]),this._markerLookup[i]=t;return e},t.prototype._allowMultiple=function(t){return t.allowMultiple=!0,t},t.prototype._getKeyFromMarkerName=function(t){if("undefined"!=typeof this._markerLookup[t])return this._markerLookup[t];for(var e in this._sprites)if("undefined"!=typeof this._sprites[e].sounds[t])return this._markerLookup[t]=e,e;return!1},t.prototype._playSpriteMarker=function(t,e,i,o,n){return void 0===o&&(o=!1),void 0===n&&(n=!0),"undefined"!=typeof i?"string"==typeof i&&(i=i.indexOf("+")>=0||i.indexOf("-")>=0?this._defaultVolume+parseFloat(i):parseFloat(i)):i=this._defaultVolume,o=o||!1,n=n===!1?!1:!0,this._sprites[t].play(e,i)},t.prototype._stopSpriteMarker=function(t,e){return"undefined"==typeof this._sprites||"undefined"==typeof this._sprites[t]?!1:this._sprites[t].stop(e)},t.prototype._stopSound=function(t){return t.stop()},t.prototype.addAudio=function(t,e){return void 0===e&&(e=!1),e===!0?this.addAudioSprite(t):this.addSound(t)},t.prototype.addSound=function(t){return"undefined"!=typeof this._sounds[t]?this._sounds[t]:(this._sounds[t]=this.game.add.audio(t),this._sounds[t].allowMultiple=!0,this._sounds[t])},t.prototype.addAudioSprite=function(t){return"undefined"!=typeof this._sprites[t]?this._sprites[t]:(this._sprites[t]=this._addAudio(t,!0),this._sprites[t])},t.prototype.playAudio=function(t,e,i,o){return void 0===i&&(i=!1),void 0===o&&(o=!0),this._getKeyFromMarkerName(t)?this.playSpriteMarker(t,e,i,o):this.playSound(t,e,i,o)},t.prototype.playDelayedAudio=function(t,e,i,o,n){return void 0===o&&(o=!1),void 0===n&&(n=!0),this._getKeyFromMarkerName(e)?this.playDelayedSpriteMarker(t,e,i,o,n):this.playDelayedSound(t,e,i,o,n)},t.prototype.playSound=function(t,e,i,o){return void 0===i&&(i=!1),void 0===o&&(o=!0),"undefined"==typeof this._sounds[t]?null:(e="undefined"==typeof e?this._defaultVolume:e,this._sounds[t].play("",0,e,i,o))},t.prototype.playSpriteMarker=function(t,e,i,o){void 0===i&&(i=!1),void 0===o&&(o=!0);var n=this._getKeyFromMarkerName(t);return n?this._playSpriteMarker(n,t,e,i,o):(console.log("marker not found",t),null)},t.prototype.playDelayedSound=function(t,e,i,o,n){return void 0===o&&(o=!1),void 0===n&&(n=!0),this.game.time.events.add(t,this.playSound,this,e,i,o,n),null},t.prototype.playDelayedSpriteMarker=function(t,e,i,o,n){return void 0===o&&(o=!1),void 0===n&&(n=!0),this.game.time.events.add(t,this.playSpriteMarker,this,e,i,o,n),null},t.prototype.stopAudio=function(t){return this._getKeyFromMarkerName(t)?this.stopSpriteMarker(t):this.stopSound(t)},t.prototype.stopSound=function(t){return"undefined"!=typeof this._sounds&&"undefined"!=typeof this._sounds[t]?this._sounds[t].stop():void 0},t.prototype.stopSpriteMarker=function(t){var e=this._getKeyFromMarkerName(t);return e?void this._stopSpriteMarker(e,t):void console.log("marker not found",t)},t.prototype.removeSound=function(t){return"undefined"==typeof this._sounds||"undefined"==typeof this._sounds[t]?!1:void(this._sounds[t]&&(this.stopSound(t),this._sounds[t].destroy(),delete this._sounds[t]))},t.prototype.removeSprite=function(t){"undefined"!=typeof this._sprites&&"undefined"!=typeof this._sprites[t]&&(this.stopSpriteMarker(t),this._sprites[t]=null,delete this._sprites[t])},t.prototype.fade=function(t,e,i,o){return void 0===o&&(o=!1),t?(t.fadeTween&&t.fadeTween&&this.game.tweens.remove(t.fadeTween),t.fadeTween=this.game.add.tween(t).to({volume:e},i||300,Phaser.Easing.Linear.None),o===!0&&t.fadeTween.onComplete.addOnce(function(){this._stopSound(t)},this),t.fadeTween.start()):void 0},Object.defineProperty(t.prototype,"defaultVolume",{get:function(){return this._defaultVolume},set:function(t){this._defaultVolume=t},enumerable:!0,configurable:!0}),t}(),t("AudioManager",h),d=function(t){function e(e){t.call(this,e),this.onWorldInputDisabled=new Phaser.Signal,this.onWorldInputEnabled=new Phaser.Signal}return __extends(e,t),e.prototype.boot=function(){t.prototype.boot.call(this),this.app=i.Application.getInstance(),this.asset=new r,this.sequence=new p,this.transition=new g,this.storage=new c,this.audio=new h,this.analytics=new s(this.config.analytics),this.add=null,this.add=new u(this),this.addLayers(),this.addMouseCallbacks(),this.setFactoryDefaultLayer(this.gameLayer)},e.prototype.addPlugins=function(){var t=this;this.config.plugins&&this.config.plugins.length>0&&this.config.plugins.forEach(function(e){"function"==typeof Phaser.Plugin[e]&&t.add.plugin(Phaser.Plugin[e])})},e.prototype.setFactoryDefaultLayer=function(t){this.add.setDefaultLayer(t||this.world)},e.prototype.addLayers=function(){this.backgroundLayer=this.add.dGroup(0,0,"_background_layer",!0),this.stage.setChildIndex(this.backgroundLayer,0),this.gameLayer=this.add.dGroup(0,0,"_game_layer"),this.uiLayer=this.add.dGroup(0,0,"_ui_layer"),this.uiLayer.fixedToCamera=!0,this.stageLayer=this.add.dGroup(0,0,"_stage_layer",!0)},e.prototype.addMouseCallbacks=function(){this.device.desktop&&(this.input.mouse.mouseOverCallback=this.mouseOver,this.input.mouse.mouseOutCallback=this.mouseOut)},e.prototype.mouseOut=function(){i.Application.getInstance().sendNotification(o.Notifications.MOUSE_LEAVE_GLOBAL)},e.prototype.mouseOver=function(){i.Application.getInstance().sendNotification(o.Notifications.MOUSE_ENTER_GLOBAL)},e.prototype.disableElementInput=function(t){if(t.input&&t.inputEnabled===!0&&(t.wasEnabled=!0,t.inputEnabled=!1),t.children.length>0)for(var e=0;e<t.children.length;e++)this.disableElementInput(t.children[e])},e.prototype.enableElementInput=function(t){if(t.input&&t.inputEnabled===!1&&t.wasEnabled&&(t.wasEnabled=!1,t.inputEnabled=!0),t.children.length>0)for(var e=0;e<t.children.length;e++)this.enableElementInput(t.children[e])},e.prototype.disableInput=function(t){return t.forEach(function(t){return t instanceof Phaser.Group?this.disableInput(t):this.disableElementInput(t)},this)},e.prototype.enableInput=function(t){return t.forEach(function(t){return t instanceof Phaser.Group?this.enableInput(t):this.enableElementInput(t)},this)},e.prototype.disableGameInput=function(){this.disableInput(this.gameLayer),this.onWorldInputDisabled.dispatch()},e.prototype.enableGameInput=function(){this.enableInput(this.gameLayer),this.onWorldInputEnabled.dispatch()},e.prototype.changeState=function(t){return this.gameLayer.removeAll(!0,!0),this.state.start(t,!1,!1)},Object.defineProperty(e.prototype,"addToGame",{get:function(){return this.add.targetGroup=this.gameLayer,this.add},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addToBackground",{get:function(){return this.add.targetGroup=this.backgroundLayer,this.add},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addToUI",{get:function(){return this.add.targetGroup=this.uiLayer,this.add},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addToStage",{get:function(){return this.add.targetGroup=this.stageLayer,this.add},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addToWorld",{get:function(){return this.add.targetGroup=this.world,this.add},enumerable:!0,configurable:!0}),e}(Phaser.Game),t("Game",d),u=function(t){function e(){t.apply(this,arguments),this._targetGroup=null,this._defaultLayer=this.world}return __extends(e,t),e.prototype.existing=function(t){var e=this.targetGroup;return this.targetGroup=null,e.add(t)},e.prototype.image=function(t,e,i,o,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.targetGroup),this.targetGroup=null,n.add(new Phaser.Image(this.game,t,e,i,o))},e.prototype.sprite=function(t,e,i,o,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.targetGroup),this.targetGroup=null,n.create(t,e,i,o)},e.prototype.creature=function(t,e,i,o,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.targetGroup),this.targetGroup=null;var s=new Phaser.Creature(this.game,t,e,i,o);return n.add(s),s},e.prototype.group=function(t,e,i,o,n){return void 0===e&&(e="group"),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===n&&(n=0),void 0===t&&i!==!0&&(t=this.targetGroup),this.targetGroup=null,new Phaser.Group(this.game,t,e,i,o,n)},e.prototype.physicsGroup=function(t,e,i,o){return void 0===t&&(t=0),void 0===i&&(i="group"),void 0===o&&(o=!1),void 0===e&&(e=this.targetGroup),this.targetGroup=null,new Phaser.Group(this.game,e,i,o,!0,t)},e.prototype.spriteBatch=function(t,e,i){return void 0===e&&(e="spriteBatch"),void 0===i&&(i=!1),void 0===t&&(t=this.targetGroup),this.targetGroup=null,new Phaser.SpriteBatch(this.game,t,e,i)},e.prototype.tileSprite=function(t,e,i,o,n,s,a){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=this.targetGroup),this.targetGroup=null,a.add(new Phaser.TileSprite(this.game,t,e,i,o,n,s))},e.prototype.rope=function(t,e,i,o,n,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===s&&(s=this.targetGroup),this.targetGroup=null,s.add(new Phaser.Rope(this.game,t,e,i,o,n))},e.prototype.text=function(t,e,i,o,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=""),void 0===n&&(n=this.targetGroup),this.targetGroup=null,n.add(new Phaser.Text(this.game,t,e,i,o))},e.prototype.button=function(t,e,i,o,n,s,a,r,h,d){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===d&&(d=this.targetGroup),this.targetGroup=null,d.add(new Phaser.Button(this.game,t,e,i,o,n,s,a,r,h))},e.prototype.graphics=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.world),i.add(new Phaser.Graphics(this.game,t,e))},e.prototype.bitmapText=function(t,e,i,o,n,s){return void 0===o&&(o=""),void 0===n&&(n=32),void 0===s&&(s=this.targetGroup),this.targetGroup=null,s.add(new Phaser.BitmapText(this.game,t,e,i,o,n))},e.prototype.dSprite=function(t,e,i,o,s,a,r){return void 0===r&&(r=this.targetGroup),this.targetGroup=null,r.add(new n.Sprite(t,e,i,o,s,a))},e.prototype.dGroup=function(t,e,i,o,s,a,r,h){return void 0===h&&o!==!0?(h=this.targetGroup,this.targetGroup=null,h.add(new n.Group(t,e,i,o,s,a,r))):new n.Group(t,e,i,o,s,a,r)},e.prototype.dText=function(t,e,i,o,s,a,r,h,d,u,p,l){return void 0===l&&(l=this.targetGroup),this.targetGroup=null,l.add(new n.Text(t,e,i,o,s,a,r,h,d,u,p))},e.prototype.setDefaultLayer=function(t){console.log("CAUTION: Changing the default layer will change the target group for .add"),this._defaultLayer=t},Object.defineProperty(e.prototype,"defaultLayer",{get:function(){return this._defaultLayer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetGroup",{get:function(){return this._targetGroup||this._defaultLayer},set:function(t){this._targetGroup=t},enumerable:!0,configurable:!0}),e}(Phaser.GameObjectFactory),t("GameObjectFactory",u),p=function(){function t(){this._defaultInterval=20,this.game=i.Application.getInstance().game}return t.prototype._executeMethod=function(t,e,i,o){var n=t.shift();"undefined"!=typeof n&&"undefined"!=typeof e&&e&&n.call(e),0===t.length&&i&&o&&i.call(o)},t.prototype.run=function(t,e,i,o,n){if("undefined"==typeof e)throw new Error("context must be provided for the sequence methods");if("undefined"==typeof i&&(i=this._defaultInterval),0===t.length&&"undefined"!=typeof o&&"undefined"!=typeof n)return void o.call(n);if(0!==i)this.game.time.events.repeat(i,t.length,this._executeMethod,this,t,e,"undefined"==typeof o?null:o,"undefined"==typeof n?null:n);else for(;t.length>0;)this._executeMethod(t,e,"undefined"==typeof o?null:o,"undefined"==typeof n?null:n)},t}(),t("SequenceManager",p),l=function(t){function e(){t.call(this),this._audio=[],this._mediator=null}return __extends(e,t),e.prototype.init=function(){},e.prototype.preload=function(){this.preloadID&&this.game.asset.loadAssets(this.preloadID)},e.prototype.create=function(){return this.game.asset.allSoundsDecoded()?(this.buildInterface(),this.afterBuildInterface(),void this.startBuild()):void this.game.asset.onLoadCompleteAndAudioDecoded.addOnce(this.create,this)},e.prototype.shutdown=function(e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),e&&this.removeMediator(),i&&this.removeAudio(),t.prototype.shutdown.call(this)},e.prototype.listBuildSequence=function(){return[]},e.prototype.buildInterface=function(){},e.prototype.afterBuildInterface=function(){},e.prototype.startBuild=function(){this.game.sequence.run(this.listBuildSequence(),this,this.buildInterval,this.preAfterBuild,this)},e.prototype.preAfterBuild=function(){"undefined"!=typeof this.game.transition&&this.game.transition.canTransitionOut()?this.game.transition.canTransitionOut()&&(this.game.transition.onTransitionOutComplete.addOnce(this.afterBuild,this),this.game.transition.transitionOut()):this.afterBuild()},e.prototype.afterBuild=function(){},e.prototype.addAudio=function(t){return this._audio||(this._audio=[]),this._audio.push(t),t},e.prototype.removeAudio=function(){var t;if(this._audio)for(;this._audio.length>0;)t=this._audio.pop(),"undefined"!=typeof t&&null!=t&&"undefined"!=typeof t.stop&&("undefined"!=typeof t.onStop&&t.onStop.removeAll(),t.stop())},e.prototype.removeMediator=function(){this._mediator&&(this._mediator.destroy(),this._mediator=null)},Object.defineProperty(e.prototype,"preloadID",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buildInterval",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"add",{get:function(){return this.game.addToGame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"app",{get:function(){return i.Application.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this.app.game},enumerable:!0,configurable:!0}),e}(Phaser.State),t("State",l),c=function(){function t(){this.game=i.Application.getInstance().game,this._init()}return t.prototype._init=function(){this._localStorageAvailable=this._getIsLocalStorageAvailable(),console.log("local storage available",this._localStorageAvailable)},t.prototype._getIsLocalStorageAvailable=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},t.prototype._getString=function(t){if("string"==typeof t)return t;var e;try{e=JSON.stringify(t)}catch(i){return console.log("Could not convert"+t+" to json"),null}return e},t.prototype.getFromLocalStorage=function(t,e){void 0===e&&(e=!0);var i=localStorage.getItem(t);return"undefined"==typeof i?(console.log("no data saved with the key",t),null):(e!==!1&&(i=JSON.parse(i)),i)},t.prototype.saveToLocalStorage=function(t,e){if(!this._localStorageAvailable)return console.log("no local storage"),!1;try{localStorage.setItem(t,this._getString(e))}catch(i){console.log("your data could not be saved")}},t.prototype.clearFromLocalStorage=function(t){if(!this._localStorageAvailable)return console.log("no local storage"),!1;try{localStorage.removeItem(t)}catch(e){}},t}(),t("StorageManager",c),g=function(){function t(){this.onTransitionOutComplete=new Phaser.Signal,this.onTransitionInComplete=new Phaser.Signal,this._transition=null,this._transitions={},this._exceptions={},this._fromState=null,this._toState=null,this.game=i.Application.getInstance().game}return t.prototype._add=function(t,e,i,o){this._transitions[t]={outHandler:e,preloadHandler:i,inHandler:o}},t.prototype._getTransition=function(t,e){var i=this._transitions[t+"/"+e];return"undefined"==typeof i&&(i=this._transitions.all),"undefined"==typeof i?null:i},t.prototype._transitionInComplete=function(){return this._transition=this._getTransition(this._fromState,this._toState),this._transition?("function"==typeof this._transition.preloadHandler.loadStart&&this.game.asset.onLoadStart.addOnce(this._transition.preloadHandler.loadStart,this._transition.preloadHandler),"function"==typeof this._transition.preloadHandler.loadProgress&&this.game.asset.onFileComplete.add(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),this.game.asset.onLoadCompleteAndAudioDecoded.addOnce(this._preloadComplete,this),this.onTransitionInComplete.dispatch(),void this.game.changeState(this._toState)):!1},t.prototype._transitionOutComplete=function(){this._transition=null,this.onTransitionOutComplete.dispatch()},t.prototype._preloadComplete=function(){return this._transition=this._getTransition(this._fromState,this._toState),this._transition?(this.game.asset.onFileComplete.remove(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),void("function"==typeof this._transition.preloadHandler.loadComplete&&this._transition.preloadHandler.loadComplete())):!1},t.prototype._clearTransition=function(){this._transition.outHandler.transitionInComplete.remove(this._transitionOutComplete,this),this._transition.inHandler.transitionOutComplete.remove(this._transitionInComplete,this),this.game.asset.onLoadCompleteAndAudioDecoded.remove(this._preloadComplete,this),this.game.asset.onLoadStart.remove(this._transition.preloadHandler.loadStart,this._transition.preloadHandler),this.game.asset.onFileComplete.remove(this._transition.preloadHandler.loadProgress,this._transition.preloadHandler),this._transition=null},t.prototype.add=function(t,e,i,o,n){var s;return arguments.length<5?"all"===t?(s=[].slice.call(arguments,1),2===arguments.length?this._add("all",s[0],s[0],s[0]):this._add("all",s[0],s[1],s[2])):(s=[].slice.call(arguments,2),this._add(t+"/"+e,s[0],s[0],s[0])):this._add(t+"/"+e,i,o,n)},t.prototype.addAll=function(t){return this._add("all",t,t,t)},t.prototype.addException=function(t){this._exceptions[t]=!0},t.prototype.remove=function(t,e){1===arguments.length?(this._transitions[t]=null,delete this._transitions[t]):(this._transitions[t+"/"+e]=null,delete this._transitions[t+"/"+e])},t.prototype.to=function(t){this._transition&&this._clearTransition(),this._exceptions[t]||(this._fromState=this.game.state.current,this._toState=t,this._transition=this._getTransition(this._fromState,this._toState),this._transition||(console.log("no transition found for:",this.game.state.current+" to "+t),this.game.changeState(this._toState)),this.transitionIn())},t.prototype.transitionIn=function(){this._transition&&"function"==typeof this._transition.outHandler.transitionIn&&(this._transition.outHandler.transitionInComplete.addOnce(this._transitionInComplete,this),this._transition.outHandler.transitionIn())},t.prototype.canTransitionOut=function(){return!this._exceptions[this.game.state.current]&&this._transition&&this._transition.inHandler&&"function"==typeof this._transition.inHandler.transitionOut},t.prototype.transitionOut=function(){this._transition.inHandler.transitionOutComplete.addOnce(this._transitionOutComplete,this),this._transition.inHandler.transitionOut()},t}(),t("TransitionManager",g)}}}),System.register("dijon/application",["dijon/core","dijon/mvc"],function(t,e){"use strict";var i,o,n;e&&e.id;return{setters:[function(t){i=t},function(t){o=t}],execute:function(){n=function(){function t(){var e=this;if(this._mediator=null,this._models={},this._mediators={},this._observerMap={},t.instance)throw Error(t.SINGLETON_MSG);t.instance=this,window.addEventListener("hashchange",function(){t._getHashQuery(),e.windowHashChange()},!1),this.createGame(),this.startGame()}return t.prototype.windowHashChange=function(){},t.prototype.createGame=function(){this.game=new i.Game({width:800,height:600,parent:"game-container",renderer:Phaser.AUTO,transparent:!1})},t.prototype.startGame=function(){},t.prototype.addPlugins=function(){this.game.addPlugins()},t.prototype.registerModel=function(t){if(this._models[t.name])throw new Error('Application:: a model with the name "'+t.name+'" already exists.');return this._models[t.name]=t,t.onRegister(),t},t.prototype.retrieveModel=function(t){return this._models[t]||null},t.prototype.removeModel=function(t){var e=t.name,i=this._models[e];i&&(i.onRemoved(),delete this._models[e])},t.prototype.registerMediator=function(t){if(this._mediators[t.name])throw new Error('Application:: a mediator with the name "'+t.name+'" already exists.');this._mediators[t.name]=t,this.registerObserver(t),t.onRegister()},t.prototype.retrieveMediator=function(t){return this._mediators[t]||null},t.prototype.removeMediator=function(t){var e=this,i=t.name,o=this._mediators[i];o&&(o.listNotificationInterests().forEach(function(t){e.removeObserver(t,o)}),o.onRemoved(),delete this._mediators[i])},t.prototype.registerObserver=function(t){var e=this;t.listNotificationInterests().forEach(function(i){void 0===e._observerMap[i]&&(e._observerMap[i]=[]),e._observerMap[i].push(t)})},t.prototype.removeObserver=function(t,e){var i=null,o=null,n=0;for(i=this._observerMap[t],n=i.length;n--;)if(o=i[n],o===e){i.splice(n,1);break}0==i.length&&delete this._observerMap[t]},t.prototype.sendNotification=function(t,e){var i=new o.Notification(t,e);this._notifyObservers(i),i.destroy(),i=null},t.prototype._notifyObservers=function(t){var e=null,i=t.getName(),o=this._observerMap[i];o&&(e=o.slice(0),e.forEach(function(e){e.handleNotification(t)}))},t._getHashQuery=function(){t._hashQuery={},window.location.hash&&void 0!==window.location.hash||(window.location.hash="");var e=window.location.hash.substr(1,window.location.hash.length),i=e.split("&");i.forEach(function(e){var i=e.split("=");t._hashQuery[i[0]]=/^\d+$/.test(i[1])?parseInt(i[1]):i[1]})},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.queryVar=function(e){return void 0===t._hashQuery&&t._getHashQuery(),t._hashQuery[e]||null},t.instance=null,t.SINGLETON_MSG="Application singleton already constructed!",t}(),t("Application",n)}}});